<!DOCTYPE HTML>

<html>
    <head>
      
     <br>
      
      <div class="js-toggle-wrapper">
  <div class="js-toggle">
    <div class="js-toggle-track">
      <div class="js-toggle-track-check">
        <img src="data:image/png;base64,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" role="presentation" style="pointer-events: none;" width="16" height="16">
          </div>
          <div class="js-toggle-track-x">
            <img src="data:image/png;base64,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" role="presentation" style="pointer-events: none;" width="16" height="16">
              </div>
              </div>
              <div class="js-toggle-thumb"></div>
                <input class="js-toggle-screenreader-only" type="checkbox" aria-label="Switch between Dark and Light mode">
                  </div>
                  </div>
  
  <style>

 

.js-toggle-wrapper {
    display: table;
    margin: 0 auto;
}

.js-toggle {
    touch-action: pan-x;
    display: inline-block;
    position: relative;
    cursor: pointer;
    background-color: transparent;
    border: 0;
    padding: 0;
    -webkit-touch-callout: none;
    user-select: none;
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    -webkit-tap-highlight-color: transparent;
  }
  
  .js-toggle-screenreader-only {
    border: 0;
    clip: rect(0 0 0 0);
    height: 1px;
    margin: -1px;
    overflow: hidden;
    padding: 0;
    position: absolute;
    width: 1px;
  }
  
  .js-toggle-track {
    width: 50px;
    height: 24px;
    padding: 0;
    border-radius: 30px;
    background-color: hsl(222, 14%, 7%);
    transition: all 0.2s ease;
  }
  
  .js-toggle-track-check {
    position: absolute;
    width: 17px;
    height: 17px;
    left: 5px;
    top: 0px;
    bottom: 0px;
    margin-top: auto;
    margin-bottom: auto;
    line-height: 0;
    opacity: 0;
    transition: opacity 0.25s ease;
  }
  
  .js-toggle--checked .js-toggle-track-check {
    opacity: 1;
    transition: opacity 0.25s ease;
  }
  
  .js-toggle-track-x {
    position: absolute;
    width: 17px;
    height: 17px;
    right: 5px;
    top: 0px;
    bottom: 0px;
    margin-top: auto;
    margin-bottom: auto;
    line-height: 0;
    opacity: 1;
    transition: opacity 0.25s ease;
  }
  
  .js-toggle--checked .js-toggle-track-x {
    opacity: 0;
  }
  
  .js-toggle-thumb {
    position: absolute;
    top: 1px;
    left: 1px;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background-color: #fafafa;
    box-sizing: border-box;
    transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1) 0ms;
    transform: translateX(0);
  }
  
  .js-toggle--checked .js-toggle-thumb {
    transform: translateX(26px);
    border-color: #19ab27;
  }
  
  .js-toggle--focus .js-toggle-thumb {
    box-shadow: 0px 0px 2px 3px rgb(255, 167, 196);
  }
  
  .js-toggle:active .js-toggle-thumb {
    box-shadow: 0px 0px 5px 5px rgb(255, 167, 196);
  }
  
  body.dark-mode , 
  body.dark-mode main * {
    background-color: #000000;
    color: #000000;
    filter: invert(0.95);
}

  .dark-mode img {
  filter: invert(1) contrast(1.3) saturate(1.4);
}

  .dark-mode p {
  color: #000000;
}
  
  .dark-mode code {
    filter: invert(1) contrast(1.3) saturate(1.4);
    font-weight: bold;
    background: #353737;
    color: white;
}

  .dark-mode strong, b {
    filter: invert(1) contrast(1.3) saturate(1.4);
  }
  
  .dark-mode #social-share ul{
    margin: 0;
    filter: invert(1) contrast(1.3) saturate(1.4);
  }

  .dark-mode #header {
    filter: invert(1) contrast(1.3) saturate(1.4);
    position: fixed;
  }

  .dark-mode .js-toggle--focus .js-toggle-thumb {
    filter: invert(1) contrast(1.3) saturate(1.4);
  }

  .dark-mode .footer {
    filter: invert(1) contrast(1.3) saturate(1.4);
    position: fixed;
    background-color: white;
    font-weight: bold;
  }

  .dark-mode .nav-secondary {
    filter: invert(1) contrast(1.3) saturate(1.4);
}

  .dark-mode #reactions .reaction-items .reaction-item .reaction-item__button img, #reactions-promotion .reaction-items .reaction-item .reaction-item__button img {
    filter: invert(1) contrast(1.3) saturate(1.4);
}

</style>

<script>
    var body = document.body;
    var article = document.article;
	var switcher = document.getElementsByClassName('js-toggle')[0];

	
	switcher.addEventListener("click", function() {
        this.classList.toggle('js-toggle--checked');
        this.classList.add('js-toggle--focus');
		
		if (this.classList.contains('js-toggle--checked')) {
			body.classList.add('dark-mode');
			article.classList.add('post.dark-mode');
			
			localStorage.setItem('darkMode', 'true');
		} else {
			body.classList.remove('dark-mode');
			article.classList.remove('post.dark-mode');
			setTimeout(function() {
				localStorage.removeItem('darkMode');
			}, 100);
		}
	})

	
	if (localStorage.getItem('darkMode')) {
		
        switcher.classList.add('js-toggle--checked');
        body.classList.add('dark-mode');
        article.classList.add('post.dark-mode');
	}

</script>


      
        <script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "https:\/\/algotech.netlify.com\/"
        },
        "articleSection" : "blog",
        "name" : "Rplicate Series: Gone Baby Gone",
        "headline" : "Rplicate Series: Gone Baby Gone",
        "description" : "Welcome again to the Rplicate Series! In this 4th article of the series, we will replicate The Economist plot titled \u0026ldquo;Gone Baby Gone\u0026rdquo;. In the process, we will explore ways to use transformed value as our axes, adding horizontal\/vertical line, and making an elbow line (and generally more flexible) annotation for repelled texts.\nLet\u0026rsquo;s dive in below!\nLoad Packages These are the packages and some set up that we will use.",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2020",
        "datePublished": "2020-11-25 00:00:00 \u002b0000 UTC",
        "dateModified" : "2020-11-25 00:00:00 \u002b0000 UTC",
        "url" : "https:\/\/algotech.netlify.com\/blog\/rplicate-series-gone-baby-gone\/",
        "wordCount" : "1789",
        "keywords" : [ "Data Visualization","Rplicate","ggplot2","Blog" ]
    }
    </script>
        
            
                <title>Rplicate Series: Gone Baby Gone</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content="Hugo 0.87.0" />
        
  
    
  

  

  <link rel="apple-touch-icon-precomposed" href='https://algotech.netlify.com/favicon/apple-touch-icon-precomposed.png'>
  <link rel="icon" href='https://algotech.netlify.com/favicon/favicon.png'>
  
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content='/favicon/mstile.png'>
  <meta name="application-name" content="Algoritma Technical Blog">
  <meta name="msapplication-tooltip" content="To learn more about our approach to data science problems, feel free to hop over to our blog.">
  <meta name="msapplication-config" content='/favicon/ieconfig.xml'>



        
            <meta name="author" content="Arga Adyatama">
        
        
            
                <meta name="description" content="To learn more about our approach to data science problems, feel free to hop over to our blog.">
            
        

        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Rplicate Series: Gone Baby Gone"/>
<meta name="twitter:description" content="Welcome again to the Rplicate Series! In this 4th article of the series, we will replicate The Economist plot titled &ldquo;Gone Baby Gone&rdquo;. In the process, we will explore ways to use transformed value as our axes, adding horizontal/vertical line, and making an elbow line (and generally more flexible) annotation for repelled texts.
Let&rsquo;s dive in below!
Load Packages These are the packages and some set up that we will use."/>
<meta name="twitter:site" content="@teamalgoritma"/>

        <meta property="og:title" content="Rplicate Series: Gone Baby Gone" />
<meta property="og:description" content="Welcome again to the Rplicate Series! In this 4th article of the series, we will replicate The Economist plot titled &ldquo;Gone Baby Gone&rdquo;. In the process, we will explore ways to use transformed value as our axes, adding horizontal/vertical line, and making an elbow line (and generally more flexible) annotation for repelled texts.
Let&rsquo;s dive in below!
Load Packages These are the packages and some set up that we will use." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://algotech.netlify.com/blog/rplicate-series-gone-baby-gone/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2020-11-25T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-11-25T00:00:00+00:00" />


        <meta property="og:image" content="https://algotech.netlify.com//images/logo.png">
        <meta property="og:image:type" content="image/png">
        <meta property="og:image:width" content="512">
        <meta property="og:image:height" content="512">
        <meta itemprop="name" content="Rplicate Series: Gone Baby Gone">
<meta itemprop="description" content="Welcome again to the Rplicate Series! In this 4th article of the series, we will replicate The Economist plot titled &ldquo;Gone Baby Gone&rdquo;. In the process, we will explore ways to use transformed value as our axes, adding horizontal/vertical line, and making an elbow line (and generally more flexible) annotation for repelled texts.
Let&rsquo;s dive in below!
Load Packages These are the packages and some set up that we will use."><meta itemprop="datePublished" content="2020-11-25T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-11-25T00:00:00+00:00" />
<meta itemprop="wordCount" content="1789">
<meta itemprop="keywords" content="Data Visualization,Rplicate,ggplot2," />
        

        
            
        

        
        
            <link disabled id="dark-mode-theme" rel="stylesheet" href="https://algotech.netlify.com/css/dark.css">
            <link rel="stylesheet" href="https://algotech.netlify.com/css/monokai-sublime.css">
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800,900|Source+Sans+Pro:400,700">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.css">
            <link rel="stylesheet" href="https://algotech.netlify.com/css/main.css">
            <link rel="stylesheet" href="https://algotech.netlify.com/css/add-on.css">
            <link rel="stylesheet" href="https://algotech.netlify.com/css/academicons.min.css">
            <link href="https://algotech.netlify.com/lib/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
            <link href="https://algotech.netlify.com/lib/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet">
            <link href="https://algotech.netlify.com/lib/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet">
            <link href="https://algotech.netlify.com/lib/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet">
        
            <link rel="stylesheet" href=
            "https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
                <link rel="stylesheet" href=
            "https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
                      integrity=
            "sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" 
                      crossorigin="anonymous">
                <script src=
            "https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js">
                </script>
                <script src=
            "https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js">
                </script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.1.0/js.cookie.js">
                </script>
                
                <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.0/jquery.cookie.min.js">
                </script>
              
                <style>
                    
                     


                    .modal:before {
                        content: '';
                        display: inline-block;
                        height: 20%;
                        vertical-align: middle;
                    }
                      
                    .modal-dialog {
                        
                    display: -webkit-box;
                    display: -webkit-flex;
                    display: -ms-flexbox;
                    display: flex;
                    -webkit-box-orient: vertical;
                    -webkit-box-direction: normal;
                    -webkit-flex-direction: column;
                        -ms-flex-direction: column;
                            flex-direction: column;
                    -webkit-box-pack: center;
                    -webkit-justify-content: center;
                        -ms-flex-pack: center;
                            justify-content: center;
                    }

                      
                    .modal .modal-content {
                        padding: 20px 20px 20px 20px;
                        -webkit-animation-name: modal-animation;
                        -webkit-animation-duration: 0.5s;
                        animation-name: modal-animation;
                        animation-duration: 1.5s;
                    }

                

                    .modal .leadin-button {
                        -webkit-border-radius: 0.25em;
                        -moz-border-radius: 0.25em;
                        -ms-border-radius: 0.25em;
                        -o-border-radius: 0.25em;
                        border-radius: 0.25em;
                        -webkit-appearance: none;
                        cursor: pointer;
                        font-size: 1em;
                        font-weight: bold;
                        line-height: 1;
                        padding: 1em 1.5em;
                        width: 100%;
                        text-decoration: none;
                    }
                    .modal .leadin-button-primary {
                        background: #a90606 !important;
                        color: #FFFFFF !important;
                    }
                      
                    @-webkit-keyframes modal-animation {
                        from {
                            top: -100px;
                            opacity: 0;
                        }
                        to {
                            top: 0px;
                            opacity: 1;
                        }
                    }
                      
                    @keyframes modal-animation {
                        from {
                            top: -100px;
                            opacity: 0;
                        }
                        to {
                            top: 0px;
                            opacity: 1;
                        }
                    }
                </style>

            <script src="content/bootstrapJS/jquery-2.1.1.min.js" type="text/javascript"></script>

            <script type="text/javascript">
                
                
                $( document ).ready(function() {
  if (document.cookie.indexOf('visited=true') == -1){
    
                      $('#signupModal').modal('show');
    
                  var year = 1000*60*60*24*365;
    var expires = new Date((new Date()).valueOf() + year);
    document.cookie = "visited=true;expires=" + expires.toUTCString();

  }
}); 

            </script>
        
            

        
            
                
            
                
                    <link rel="stylesheet" href="https://algotech.netlify.com/css/main.css">
                
            
        


  
    
      <link rel="stylesheet" href="https://algotech.netlify.com/css/monokai-sublime.css" rel="stylesheet" id="theme-stylesheet">
      <script src="https://algotech.netlify.com/js/highlight.pack.js"></script>
      <script>hljs.initHighlightingOnLoad();</script>
  


      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-164959107-2', 'auto');
	
	ga('send', 'pageview');
}
</script>



      
    </head>
    <body>

        <div class="modal" id="signupModal"
        role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
 
       <div class="modal-dialog">
           <div class="modal-content">
 
               
               <div class="m-header">
                   <button class="close" data-dismiss="modal">
                       ×
                   </button>
                   <h2 class="myModalLabel"> Upcoming Workshop! </h2>
               </div>
 
               
               <div class="inputs">
 
                <a href="https://algorit.ma/ds-course/dss-trading/?utm_source=algotech"><img src="https://algotech.netlify.com/img/2021/ads/dss_okt.png",
                     alt="Building Algorithmic Trading Dashboard", style="float: left; padding-right: 20px;" padding: 1px  width="30%" height="30%"></a>
                <p>This 3-day online workshop is a beginner-friendly introduction to algorithmic trading using the Python programming language. Throughout the online course, we will provide you with hands-on examples and a rich interactive experience. One Instructor and two Teaching Assistants will help you to troubleshoot or help with any difficulties encountered.</p>
                <div class="advance-wrapper callout-special-font">
                    <a href="https://algorit.ma/ds-course/dss-trading/?utm_source=algotech" target="_blank" 
                    class="leadin-button leadin-advance-button leadin-button-primary">LEARN MORE</a>
                </div>
               </div>
 
 
           </div>
       </div>
   </div>

    </body>

      
      <div id="wrapper">

    
    
<header id="header">
    
      <h1><a href="https://algotech.netlify.com/">blog</a></h1>
    

    <nav class="links">
        <ul>
            
                <li>
                    <a href="https://algotech.netlify.com/">
                            <i class="fa fa-home">&nbsp;</i>Home
                    </a>
                </li>
            
                <li>
                    <a href="https://algotech.netlify.com/tags/machine-learning/">
                            <i class="fa fa-cog">&nbsp;</i>Machine Learning
                    </a>
                </li>
            
                <li>
                    <a href="https://algotech.netlify.com/tags/data-visualization/">
                            <i class="fa fa-area-chart">&nbsp;</i>Data Visualization
                    </a>
                </li>
            
                <li>
                    <a href="https://algotech.netlify.com/tags/">
                            <i class="fa fa-list">&nbsp;</i>Article List
                    </a>
                </li>
            
        </ul>
    </nav>
    <nav class="main">
        <ul>
            
            <li id="share-nav" class="share-menu" style="display:none;">
                <a class="fa-share-alt" href="#share-menu">Share</a>
            </li>
            
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="//google.com/search">
                    <input type="text" name="q" placeholder="Search" />
                    <input type="hidden" name="as_sitesearch" value="https://algotech.netlify.com/">
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>


<section id="menu">

    
        <section>
            <form class="search" method="get" action="//google.com/search">
                <input type="text" name="q" placeholder="Search" />
                <input type="hidden" name="as_sitesearch" value="https://algotech.netlify.com/">
            </form>
        </section>

    
        <section>
            <ul class="links">
                
                    <li>
                        <a href="https://algotech.netlify.com/">
                            <h3>
                                <i class="fa fa-home">&nbsp;</i>Home
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://algotech.netlify.com/tags/machine-learning/">
                            <h3>
                                <i class="fa fa-cog">&nbsp;</i>Machine Learning
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://algotech.netlify.com/tags/data-visualization/">
                            <h3>
                                <i class="fa fa-area-chart">&nbsp;</i>Data Visualization
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://algotech.netlify.com/tags/">
                            <h3>
                                <i class="fa fa-list">&nbsp;</i>Article List
                            </h3>
                        </a>
                    </li>
                
            </ul>
        </section>

    
        <section class="recent-posts">
            <div class="mini-posts">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                

                
                    
                

                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://algotech.netlify.com/blog/regression-arima-arimax/">Regression ARIMA (ARIMAX)</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-09-09'>
                                    September 9, 2021</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://algotech.netlify.com/blog/hotel-forecast/">Multiple Hotel Segments Demand Forecasting</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-07-30'>
                                    July 30, 2021</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://algotech.netlify.com/blog/advancing-your-shinyapp-ii/">Advancing Your Shiny Application II</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-06-03'>
                                    June 3, 2021</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://algotech.netlify.com/blog/gridsearchcv/">GridSearchCV</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-05-22'>
                                    May 22, 2021</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://algotech.netlify.com/blog/kemiripan-teks/">Pengenalan Kemiripan Teks (Text Similarity) di Python</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-05-20'>
                                    May 20, 2021</time>
                            </header>
                            

                        </article>
                

                
                    <a href=
                        
                            /blog/
                        
                        class="button">View more posts</a>
                
            </div>
        </section>

    
        
</section>

    <section id="share-menu">
    <section id="social-share-nav">
        <ul class="links">
            <header>
                <h3>Share this post <i class="fa fa-smile-o"></i></h3>
            </header>
            



<li>
  <a href="https://twitter.com/intent/tweet?text=Rplicate%20Series%3a%20Gone%20Baby%20Gone by Arga%20Adyatama&amp;url=https%3a%2f%2falgotech.netlify.com%2fblog%2frplicate-series-gone-baby-gone%2f" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>








<li>
  <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2falgotech.netlify.com%2fblog%2frplicate-series-gone-baby-gone%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
    </a>
</li>







<li>
  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2falgotech.netlify.com%2fblog%2frplicate-series-gone-baby-gone%2f&amp;title=Rplicate%20Series%3a%20Gone%20Baby%20Gone" target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>











        </ul>
    </section>
</section>

    
    <div id="main">
        
        
        <article class="post">
  <header>
    <div class="title">
        
            <h2><a href="https://algotech.netlify.com/blog/rplicate-series-gone-baby-gone/">Rplicate Series: Gone Baby Gone</a></h2>
        
        
    </div>
    <div class="meta">
        

        <time class="published"
            datetime='2020-11-25'>
            November 25, 2020</time>
        <span class="author"><a href="https://github.com/Argaadya">Arga Adyatama</a></span>
        
            <p>9 minute read</p>
        
        
    </div>
</header>


  
    <section id="social-share">
      <ul class="icons">
        



<li>
  <a href="https://twitter.com/intent/tweet?text=Rplicate%20Series%3a%20Gone%20Baby%20Gone by Arga%20Adyatama&amp;url=https%3a%2f%2falgotech.netlify.com%2fblog%2frplicate-series-gone-baby-gone%2f" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>








<li>
  <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2falgotech.netlify.com%2fblog%2frplicate-series-gone-baby-gone%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
    </a>
</li>







<li>
  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2falgotech.netlify.com%2fblog%2frplicate-series-gone-baby-gone%2f&amp;title=Rplicate%20Series%3a%20Gone%20Baby%20Gone" target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>











      </ul>
    </section>
  

  
    

    
        
        







  
  
    
  


        
        
        

        <a href="https://algotech.netlify.com/blog/rplicate-series-gone-baby-gone/" class="image featured">
            <img src="https://algotech.netlify.com/img/2020/11/gone-baby-gone.png" alt="">
        </a>
    


  <div id="content">
    <p>Welcome again to the Rplicate Series! In this 4th article of the series, we will replicate The Economist plot titled <em>&ldquo;Gone Baby Gone&rdquo;</em>. In the process, we will explore ways to use <strong>transformed value as our axes</strong>, adding <strong>horizontal/vertical line</strong>, and making an <strong>elbow line</strong> (and generally more flexible) annotation for repelled texts.</p>
<!-- raw HTML omitted -->
<p>Let&rsquo;s dive in below!</p>
<h1 id="load-packages">Load Packages</h1>
<p>These are the packages and some set up that we will use.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">library</span>(tidyverse) <span style="color:#75715e"># for data wrangling</span>
<span style="color:#a6e22e">library</span>(scales) <span style="color:#75715e"># customize axes in plot</span>
<span style="color:#a6e22e">library</span>(ggrepel) <span style="color:#75715e"># add &amp; customize repelled text</span>
<span style="color:#a6e22e">library</span>(ggthemes) <span style="color:#75715e"># provide previously made themes</span>
<span style="color:#a6e22e">library</span>(grid) <span style="color:#75715e"># enhance the layouting of plot</span>
<span style="color:#a6e22e">options</span>(scipen <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>) <span style="color:#75715e"># to prevent R displaying scientific notation</span>
</code></pre></div><h1 id="dataset">Dataset</h1>
<p>The plot we are going to make tells us about the decrease of South Korean women fertility rates which falls to a record low, as reported in the <a href="https://www.economist.com/graphic-detail/2019/08/30/south-koreas-fertility-rate-falls-to-a-record-low">original article</a>.</p>
<h2 id="data-collection">Data Collection</h2>
<p>The data was acquired from World Bank and downloaded bofore use:</p>
<ul>
<li>Fertility Rate data: <a href="https://data.worldbank.org/indicator/SP.DYN.TFRT.IN">https://data.worldbank.org/indicator/SP.DYN.TFRT.IN</a></li>
<li>Population data: <a href="https://data.worldbank.org/indicator/SP.POP.TOTL?end=2018&amp;start=1996">https://data.worldbank.org/indicator/SP.POP.TOTL?end=2018&amp;start=1996</a></li>
<li>GDP per Capita data: <a href="https://data.worldbank.org/indicator/NY.GDP.PCAP.CD">https://data.worldbank.org/indicator/NY.GDP.PCAP.CD</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data_tfr <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read_csv</span>(file <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;data_input/world_bank_fertility.csv&#34;</span>,
                     skip <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>)
data_pop <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read_csv</span>(file <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;data_input/world_bank_pop.csv&#34;</span>,
                     skip <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>)
data_gdp <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read_csv</span>(file <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;data_input/world_bank_gdp.csv&#34;</span>,
                     skip <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>)
</code></pre></div><h2 id="data-preprocessing">Data Preprocessing</h2>
<p>Since the article only use the population data from 2017, we will clean the data first.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># selecting data from 2017</span>

<span style="color:#75715e">## fertility rates</span>
data_tfr <span style="color:#f92672">&lt;-</span> data_tfr <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(`Country Name`,<span style="color:#e6db74">&#39;2017&#39;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">rename</span>(tfr <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2017&#34;</span>)

<span style="color:#75715e">## population</span>
data_pop <span style="color:#f92672">&lt;-</span> data_pop <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(`Country Name`,<span style="color:#e6db74">&#39;2017&#39;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">rename</span>(pop <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2017&#34;</span>)

<span style="color:#75715e">## gdp</span>
data_gdp <span style="color:#f92672">&lt;-</span> data_gdp <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(`Country Name`,<span style="color:#e6db74">&#39;2017&#39;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">rename</span>(gdp <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2017&#34;</span>)

<span style="color:#a6e22e">head</span>(data_tfr,<span style="color:#ae81ff">10</span>)
</code></pre></div><pre><code>#&gt; # A tibble: 10 x 2
#&gt;    `Country Name`         tfr
#&gt;    &lt;chr&gt;                &lt;dbl&gt;
#&gt;  1 Aruba                 1.80
#&gt;  2 Afghanistan           4.48
#&gt;  3 Angola                5.62
#&gt;  4 Albania               1.71
#&gt;  5 Andorra              NA   
#&gt;  6 Arab World            3.27
#&gt;  7 United Arab Emirates  1.73
#&gt;  8 Argentina             2.28
#&gt;  9 Armenia               1.60
#&gt; 10 American Samoa       NA
</code></pre><p>Next, we will combine the data while also removing NAs and arrange the data descendingly based on population:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">df <span style="color:#f92672">&lt;-</span> data_tfr <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">left_join</span>(data_pop) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">left_join</span>(data_gdp) <span style="color:#f92672">%&gt;%</span>  
  <span style="color:#a6e22e">na.omit</span>() <span style="color:#f92672">%&gt;%</span>                 
  <span style="color:#a6e22e">rename</span>(country <span style="color:#f92672">=</span> `Country Name`) <span style="color:#f92672">%&gt;%</span>  
  <span style="color:#a6e22e">arrange</span>(<span style="color:#a6e22e">desc</span>(pop)) 

<span style="color:#75715e"># quick check</span>
<span style="color:#a6e22e">head</span>(df, <span style="color:#ae81ff">40</span>)
</code></pre></div><pre><code>#&gt; # A tibble: 40 x 4
#&gt;    country                      tfr        pop    gdp
#&gt;    &lt;chr&gt;                      &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
#&gt;  1 World                       2.43 7510990456 10769.
#&gt;  2 IDA &amp; IBRD total            2.55 6335039629  4859.
#&gt;  3 Low &amp; middle income         2.56 6306560891  4743.
#&gt;  4 Middle income               2.33 5619111361  5229.
#&gt;  5 IBRD only                   2.07 4731120193  6052.
#&gt;  6 Early-demographic dividend  2.51 3207188541  3545.
#&gt;  7 Lower middle income         2.76 2981420591  2187.
#&gt;  8 Upper middle income         1.84 2637690770  8663.
#&gt;  9 East Asia &amp; Pacific         1.80 2314202003 10333.
#&gt; 10 Late-demographic dividend   1.71 2276319334  8943.
#&gt; # ... with 30 more rows
</code></pre><p>Look at the table above! Looks like we have some previously made clusters of countries in the data. To prevent redundancy, we need to remove them first.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">df <span style="color:#f92672">&lt;-</span> df <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">slice</span>(<span style="color:#f92672">-</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">18</span><span style="color:#f92672">:</span><span style="color:#ae81ff">43</span>))
<span style="color:#a6e22e">head</span>(df,<span style="color:#ae81ff">10</span>)
</code></pre></div><pre><code>#&gt; # A tibble: 10 x 4
#&gt;    country              tfr        pop    gdp
#&gt;    &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
#&gt;  1 China               1.63 1386395000  8759.
#&gt;  2 India               2.30 1338658835  1981.
#&gt;  3 United States       1.77  325147121 59928.
#&gt;  4 Indonesia           2.34  264645886  3837.
#&gt;  5 Pakistan            3.41  207896686  1467.
#&gt;  6 Brazil              1.71  207833831  9881.
#&gt;  7 Nigeria             5.46  190873311  1969.
#&gt;  8 Bangladesh          2.08  159670593  1564.
#&gt;  9 Russian Federation  1.76  144496740 10751.
#&gt; 10 Japan               1.43  126785797 38332.
</code></pre><p>Now we are ready to make the plot.</p>
<h1 id="plotting">Plotting</h1>
<h2 id="scatter-plot">Scatter Plot</h2>
<p>First, we plot the data into scatter plot which the size of the dot indicating the population size.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> df <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> gdp, y <span style="color:#f92672">=</span> tfr, size <span style="color:#f92672">=</span> pop),
             color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#62c9d8&#34;</span>,
             alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>,
             show.legend <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>)
p
</code></pre></div><p><!-- raw HTML omitted --></p>
<h2 id="set-axis--aesthetic">Set Axis &amp; Aesthetic</h2>
<p>As you can see above, the mapping between x and y values are quite extreme (forming a curve pointing at a position near zero at both axis). We can smooth the visualization by <strong>using transformed value for our axes</strong>. We will use the <em>log10 scale</em> for our x-axis since the values are high in range and possible for the transformation.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">scale_x_continuous</span>(trans <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;log10&#34;</span>, <span style="color:#75715e"># there are many more transformation function that you can explore!</span>
                     expand <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.05</span>,<span style="color:#ae81ff">0</span>), <span style="color:#75715e"># adjusting spaces on the min-max</span>
                     labels <span style="color:#f92672">=</span> <span style="color:#a6e22e">number_format</span>(big.mark <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;,&#34;</span>), <span style="color:#75715e"># add comma to axis labels</span>
                     limits <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">100</span>,<span style="color:#ae81ff">110000</span>))
p
</code></pre></div><p><!-- raw HTML omitted --></p>
<p>Next, we can also set the y-axis:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">scale_y_continuous</span>(breaks <span style="color:#f92672">=</span> <span style="color:#a6e22e">seq</span>(from <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, to <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>, by <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>),
                     limits <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">8.3</span>),
                     position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;right&#34;</span>,
                     expand <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>))

p
</code></pre></div><p><!-- raw HTML omitted --></p>
<p>Following the transformation, we can also scale the aesthetic element <code>size</code> using <code>scale_size_continues()</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">scale_size_continuous</span>(range <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">16</span>))

p
</code></pre></div><p><!-- raw HTML omitted --></p>
<h2 id="line--annotation">Line &amp; Annotation</h2>
<p>Next, we will add a horizontal line representing &ldquo;Replacement Fertility Level&rdquo; using <code>geom_hline()</code>. As a side note, you can use <code>geom_vline()</code> and set the <em>xintercept</em> aesthetic to add a vertical line.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_hline</span>(<span style="color:#a6e22e">aes</span>(yintercept<span style="color:#f92672">=</span> <span style="color:#ae81ff">2.1</span>),
             color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#edb0ad&#34;</span>,
             linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dashed&#34;</span>,
             size<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)

p
</code></pre></div><p><!-- raw HTML omitted --></p>
<p>We will also add text annotation for the line and the text below it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>,y <span style="color:#f92672">=</span> <span style="color:#ae81ff">2.4</span>, label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Replacement fertility level&#34;</span>),
            color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#e07b78&#34;</span>,
            hjust <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;left&#34;</span>,
            size <span style="color:#f92672">=</span> <span style="color:#ae81ff">4.5</span>)
p
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Circle size = Population, 2017&#34;</span>),
            color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#8e9093&#34;</span>,
            hjust <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;left&#34;</span>,
            size <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>)

p
</code></pre></div><p><!-- raw HTML omitted --></p>
<h2 id="customize-repelled-text">Customize Repelled Text</h2>
<p>Now we will highlights and add annotation for selected countries. Since the annotation line is an elbow shape, we need to be creative. To my best knowledge, there is no packages that can directly make an elbow annotation. I&rsquo;ll show you how to make one using a combination of <code>geom_text_repel()</code> and <code>geom_segment()</code>.</p>
<p>We will manually add the text one by one based on how it positioned on the plot. First, let&rsquo;s add the Niger text which is quite simple compared to the others. Notice that we need to filter the data first so that we can custom the repelled text individually for each selected country.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># filter the data to be used</span>
df_niger <span style="color:#f92672">&lt;-</span> df <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">filter</span>(country <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Niger&#34;</span>)

p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text_repel</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> gdp, y <span style="color:#f92672">=</span> tfr, label <span style="color:#f92672">=</span> country),
                  data <span style="color:#f92672">=</span> df_niger,
                  nudge_x <span style="color:#f92672">=</span> <span style="color:#ae81ff">-.15</span>, <span style="color:#75715e"># position from the x aesthetic</span>
                  direction <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;x&#34;</span>) <span style="color:#75715e"># direction of the label/repelled text (x/y)</span>

p
</code></pre></div><p><!-- raw HTML omitted --></p>
<p>Then we higlight the point of Niger by layering the plot using new <code>geom_point()</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> gdp, y <span style="color:#f92672">=</span> tfr, size <span style="color:#f92672">=</span> pop),
             data <span style="color:#f92672">=</span> df_niger,
             shape <span style="color:#f92672">=</span> <span style="color:#ae81ff">21</span>,
             fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#2fc1d3&#34;</span>,
             color <span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>, 
             show.legend <span style="color:#f92672">=</span> F)
p
</code></pre></div><p><!-- raw HTML omitted --></p>
<p>The second one is for India and China. This one is more complicated for we have to create an elbow line. We can do that by using a combination of <code>geom_segment()</code> and <code>geom_text_repel()</code>. We first have to create a small vertical line as the starting point of the elbow line. We can use <code>geom_segment()</code> as seen below.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># filter the data to be used</span>
df_inch <span style="color:#f92672">&lt;-</span> df <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">filter</span>(country <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;India&#34;</span>,<span style="color:#e6db74">&#34;China&#34;</span>))

p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_segment</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> gdp, xend <span style="color:#f92672">=</span> gdp, y <span style="color:#f92672">=</span> tfr, yend <span style="color:#f92672">=</span> tfr<span style="color:#ae81ff">-.7</span>),
               data <span style="color:#f92672">=</span> df_inch)
  
p
</code></pre></div><p><!-- raw HTML omitted --></p>
<p>and then we can use <code>geom_text_repel()</code> to make the repelled text, following from the previously made position of <code>geom_segment()</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text_repel</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> gdp, y <span style="color:#f92672">=</span> tfr<span style="color:#ae81ff">-.7</span>, label <span style="color:#f92672">=</span> country),
                  data <span style="color:#f92672">=</span> df_inch,
                  nudge_x <span style="color:#f92672">=</span> <span style="color:#ae81ff">-.3</span>,
                  direction <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;x&#34;</span>)
p
</code></pre></div><p><!-- raw HTML omitted --></p>
<p>Do not forget to highlight the point:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>(<span style="color:#a6e22e">aes</span>(gdp, tfr, size <span style="color:#f92672">=</span> pop),
             data <span style="color:#f92672">=</span> df_inch,
             shape <span style="color:#f92672">=</span> <span style="color:#ae81ff">21</span>,
             fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#2fc1d3&#34;</span>,
             color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, 
             show.legend <span style="color:#f92672">=</span> F)

p
</code></pre></div><p><!-- raw HTML omitted --></p>
<p>We can follow the previous step for the other countries as it follows a similar pattern:</p>
<ol>
<li>Create <code>geom_segment()</code> (if we need to)</li>
<li>Create <code>geom_text_repel()</code> and set its direction</li>
<li>Highlight the point using new <code>geom_point()</code></li>
</ol>
<p>Below is the code for the other countries:</p>
<ul>
<li>Japan &amp; United States</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># filter the data to be used</span>
df_japus <span style="color:#f92672">&lt;-</span> df <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">filter</span>(country <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Japan&#34;</span>,<span style="color:#e6db74">&#34;United States&#34;</span>))

p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text_repel</span>(<span style="color:#a6e22e">aes</span>(gdp, tfr, label <span style="color:#f92672">=</span> country),
                  data <span style="color:#f92672">=</span> df_japus,
                  nudge_y <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.5</span>,
                  direction <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;y&#34;</span>)
p
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>(<span style="color:#a6e22e">aes</span>(gdp, tfr, size <span style="color:#f92672">=</span> pop),
             data <span style="color:#f92672">=</span> df_japus,
             shape <span style="color:#f92672">=</span> <span style="color:#ae81ff">21</span>,
             fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#2fc1d3&#34;</span>,
             color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>,
             show.legend <span style="color:#f92672">=</span> F)
p
</code></pre></div><p><!-- raw HTML omitted --></p>
<ul>
<li>Hongkong</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># filter the data to be used</span>
df_hongkong <span style="color:#f92672">&lt;-</span> df <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">filter</span>(country <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Hong Kong SAR, China&#34;</span>)
df_hongkong <span style="color:#f92672">&lt;-</span> df_hongkong <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">mutate</span>(country <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hong Kong&#34;</span>)

p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text_repel</span>(<span style="color:#a6e22e">aes</span>(gdp, tfr, label<span style="color:#f92672">=</span>country),
                  data <span style="color:#f92672">=</span> df_hongkong,
                  nudge_y <span style="color:#f92672">=</span> <span style="color:#ae81ff">-.7</span>,
                  direction <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;y&#34;</span>)
p
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>(<span style="color:#a6e22e">aes</span>(gdp, tfr, size <span style="color:#f92672">=</span> pop),
             data <span style="color:#f92672">=</span> df_hongkong,
             shape <span style="color:#f92672">=</span> <span style="color:#ae81ff">21</span>,
             fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#2fc1d3&#34;</span>,
             color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>,
             show.legend <span style="color:#f92672">=</span> F)
p
</code></pre></div><p><!-- raw HTML omitted --></p>
<ul>
<li>Singapore</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># filter the data to be used</span>
df_sing <span style="color:#f92672">&lt;-</span> df <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">filter</span>(country <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Singapore&#34;</span>)

p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_segment</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> gdp, xend <span style="color:#f92672">=</span> gdp, y <span style="color:#f92672">=</span> tfr, yend <span style="color:#f92672">=</span> tfr<span style="color:#ae81ff">-.5</span>),
               data <span style="color:#f92672">=</span> df_sing,
               color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>)
p
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text_repel</span>(<span style="color:#a6e22e">aes</span>(gdp, tfr<span style="color:#ae81ff">-.5</span>, label <span style="color:#f92672">=</span> country),
                  data <span style="color:#f92672">=</span> df_sing,
                  color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>,
                  nudge_x <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>,
                  direction <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;x&#34;</span>)

p
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>(<span style="color:#a6e22e">aes</span>(gdp, tfr, size <span style="color:#f92672">=</span> pop),
             data <span style="color:#f92672">=</span> df_sing,
             shape <span style="color:#f92672">=</span> <span style="color:#ae81ff">21</span>,
             fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#2fc1d3&#34;</span>,
             color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>,
             show.legend <span style="color:#f92672">=</span> F)

p
</code></pre></div><p><!-- raw HTML omitted --></p>
<ul>
<li>South Korea</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># filter the data to be used</span>
df_kor <span style="color:#f92672">&lt;-</span> df <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">filter</span>(country <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Korea, Rep.&#34;</span>)
df_kor <span style="color:#f92672">&lt;-</span> df_kor <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">mutate</span>(country <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;South Korea&#34;</span>)

p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_segment</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> gdp, xend <span style="color:#f92672">=</span> gdp, y <span style="color:#f92672">=</span> tfr, yend <span style="color:#f92672">=</span> tfr<span style="color:#ae81ff">-.5</span>),
               data <span style="color:#f92672">=</span> df_kor)
p
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text_repel</span>(<span style="color:#a6e22e">aes</span>(gdp, tfr<span style="color:#ae81ff">-.5</span>, label <span style="color:#f92672">=</span> country),
                  data <span style="color:#f92672">=</span> df_kor,
                  nudge_x <span style="color:#f92672">=</span> <span style="color:#ae81ff">-.3</span>,
                  direction <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;x&#34;</span>,
                  fontface <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>) <span style="color:#75715e"># bold font, spesifically set for Korea</span>

p
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>(<span style="color:#a6e22e">aes</span>(gdp, tfr, size <span style="color:#f92672">=</span> pop),
             data <span style="color:#f92672">=</span> df_kor,
             shape <span style="color:#f92672">=</span> <span style="color:#ae81ff">21</span>,
             fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#2fc1d3&#34;</span>,
             color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, 
             show.legend <span style="color:#f92672">=</span> F)

p
</code></pre></div><p><!-- raw HTML omitted --></p>
<h2 id="title--label">Title &amp; Label</h2>
<p>Next we can add and customize title and label for the plot.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
   <span style="color:#a6e22e">labs</span>(title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Gone baby gone&#34;</span>,
       subtitle <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;GDP and fertility, 2017                                                                                                          Fertility Rate&#34;</span>,
       x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;\n GDP per capita, $, log scale&#34;</span>, <span style="color:#75715e">#\n for adding space between axis and x-axis</span>
       y <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
        caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Source: World Bank&#34;</span>)

p
</code></pre></div><p><!-- raw HTML omitted --></p>
<h2 id="plot-theme">Plot Theme</h2>
<p>And as a finishing touch, we can customize theme for our plot.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(plot.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(),
        panel.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(),
        panel.grid.major.y <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_line</span>(colour <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;gray80&#34;</span>))
p
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(axis.ticks.length.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">unit</span>(<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#34;mm&#34;</span>),
        axis.ticks.y <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(),
        axis.line.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_line</span>(color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>),
        axis.text.y <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(vjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>),
        axis.title.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(colour <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>))
p
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(plot.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
        plot.caption <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;gray30&#34;</span>, hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>))
</code></pre></div><h2 id="final-result">Final Result</h2>
<p>Now let&rsquo;s display our final plot!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p
</code></pre></div><p><!-- raw HTML omitted --></p>
<p>Thank you for reading and we hope this article can help you to create a more interesting visualization. We hope you can find the delight in exploring data visualization in R. Happy learning and coding!</p>

  </div>

  <footer>
    <ul class="stats">
  <li class="categories">
    <ul>
        
            
            
                <i class="fa fa-folder"></i>
                
                
                <li><a class="article-category-link" href="https://algotech.netlify.com/categories/r">R</a></li>
                
            
        
    </ul>
  </li>
  <li class="tags">
    <ul>
        
            
            
                <i class="fa fa-tags"></i>
                
                
                <li><a class="article-category-link" href="https://algotech.netlify.com/tags/data-visualization">Data Visualization</a></li>
                
                
                <li><a class="article-category-link" href="https://algotech.netlify.com/tags/rplicate">Rplicate</a></li>
                
                
                <li><a class="article-category-link" href="https://algotech.netlify.com/tags/ggplot2">ggplot2</a></li>
                
            
        
    </ul>
  </li>
</ul>

  </footer>

</article>

    <article class="post">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-algotech-netlify-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </article>


<ul class="actions pagination">
    
        <li><a href="https://algotech.netlify.com/blog/xgboost/"
                class="button big previous">Boosting Algorithm (AdaBoost and XGBoost)</a></li>
    

    
        <li><a href="https://algotech.netlify.com/blog/rplicate-series-coronavirus-survey/"
                class="button big next">Rplicate Series: Interactive Plot of Coronavirus Survey</a></li>
    
</ul>


    </div>
    
<section id="sidebar">

  
  <section id="intro">
    
    
      
        <a href='https://algotech.netlify.com/'><img src="https://algotech.netlify.com/img/main/logo.png" class="intro-circle" width="30%" alt="Hugo Future Imperfect" /></a>
      
    
    
      <header>
        <h2>Algoritma Technical Blog</h2>
        <p>We're a group of people who teach data science to individuals, trains companies and their employees to better profit from data. We care about the development of data science and a sense of community that connects our alumni and team with one another. To learn more about our approach to data science problems, feel free to hop over to our blog.</p>
      </header>
    
    
      <ul class="icons">
        
        
  <li><a href="//github.com/teamalgoritma" target="_blank" title="GitHub" class="fa fa-github"></a></li>



























  <li><a href="//linkedin.com/company/teamalgoritma" target="_blank" title="LinkedIn Company" class="fa fa-linkedin"></a></li>









  <li><a href="//facebook.com/teamalgoritma" target="_blank" title="Facebook" class="fa fa-facebook"></a></li>





















  <li><a href="//instagram.com/teamalgoritma" target="_blank" title="Instagram" class="fa fa-instagram"></a></li>





  <li><a href="//twitter.com/teamalgoritma" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>




















      </ul>
    
  </section>

  
  <section class="recent-posts">
    <div class="mini-posts">
      <header>
        <h3>Upcoming Workshop</h3>
      </header>
      <div class="posts-container">
          <article class="mini-post">
            <header>
              
              
              <h3>
                <a href="https://algorit.ma/ds-course/dss-trading/?utm_source=algotech"><img src="https://algotech.netlify.com/img/2021/ads/dss_okt.png", alt="Building Algorithmic Trading Dashboard",  width="270" height="340">More details</a>
              </h3>
              
              <h3>
                <a href="https://algorit.ma/dds-oil-gas/?utm_source=algotech"><img src="https://algotech.netlify.com/img/2021/ads/dds-oilgas.png", alt="DDS: Secrets to a Successful Analytics Project in the Oil and Gas Industry",  width="270" height="340">More details</a>
              </h3>
            </header>
          </article>
      </div>

      
      
    </div>
  </section>

  
  
  

  
  

  
  <section id="footer">
    <p class="copyright">
      
        &copy; 2021
        
          Algoritma Technical Blog
        
      .
      Powered by <a href="//gohugo.io" target="_blank">Hugo</a>
    </p>
  </section>
</section>

    </div>
    <a id="back-to-top" href="#" class="fa fa-arrow-up fa-border fa-2x"></a>
    <style>
      .footer {
        position: fixed;
        left: 0;
        bottom: 0;
        width: 100%;
        height:50px; 
        background-color: black;
        color: white;
        text-align: center;
        padding-top: 15px;
        padding-bottom: 15px;
        padding-left: 50px;
        padding-right: 50px;
}
      }


      </style>

      <div class="footer">
        <p>
          Want to know more about our workshop?
          <a href="https://algorit.ma/?utm_source=algotech&utm_medium=content&utm_campaign=rplicate-series-gone-baby-gone" style="color: rgb(197, 38, 38)"> Visit our main website here</a> <br>
        </p>
          
      </div>
    

    
      
    

    
      
      
      
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>
        
        
        
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/yaml.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/css.min.js"></script>
        <script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>
      
    
    
    
      <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.js"></script>
      <script src="https://algotech.netlify.com/js/util.js"></script>
      <script src="https://algotech.netlify.com/js/main.js"></script>
      <script src="https://algotech.netlify.com/js/backToTop.js"></script>
    

    
      
        
      
        
          <script src="https://algotech.netlify.com/js/bootstrap.min.js"></script>
        
      
    

    
    <script>hljs.initHighlightingOnLoad();</script>
      <script src="//yihui.name/js/math-code.js"></script>
<script async
src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


  </body>
</html>

