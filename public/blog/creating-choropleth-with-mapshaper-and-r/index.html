<!DOCTYPE HTML>

<html>
    <head>
      
     <br>
      
      <div class="js-toggle-wrapper">
  <div class="js-toggle">
    <div class="js-toggle-track">
      <div class="js-toggle-track-check">
        <img src="data:image/png;base64,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" role="presentation" style="pointer-events: none;" width="16" height="16">
          </div>
          <div class="js-toggle-track-x">
            <img src="data:image/png;base64,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" role="presentation" style="pointer-events: none;" width="16" height="16">
              </div>
              </div>
              <div class="js-toggle-thumb"></div>
                <input class="js-toggle-screenreader-only" type="checkbox" aria-label="Switch between Dark and Light mode">
                  </div>
                  </div>
  
  <style>

 

.js-toggle-wrapper {
    display: table;
    margin: 0 auto;
}

.js-toggle {
    touch-action: pan-x;
    display: inline-block;
    position: relative;
    cursor: pointer;
    background-color: transparent;
    border: 0;
    padding: 0;
    -webkit-touch-callout: none;
    user-select: none;
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    -webkit-tap-highlight-color: transparent;
  }
  
  .js-toggle-screenreader-only {
    border: 0;
    clip: rect(0 0 0 0);
    height: 1px;
    margin: -1px;
    overflow: hidden;
    padding: 0;
    position: absolute;
    width: 1px;
  }
  
  .js-toggle-track {
    width: 50px;
    height: 24px;
    padding: 0;
    border-radius: 30px;
    background-color: hsl(222, 14%, 7%);
    transition: all 0.2s ease;
  }
  
  .js-toggle-track-check {
    position: absolute;
    width: 17px;
    height: 17px;
    left: 5px;
    top: 0px;
    bottom: 0px;
    margin-top: auto;
    margin-bottom: auto;
    line-height: 0;
    opacity: 0;
    transition: opacity 0.25s ease;
  }
  
  .js-toggle--checked .js-toggle-track-check {
    opacity: 1;
    transition: opacity 0.25s ease;
  }
  
  .js-toggle-track-x {
    position: absolute;
    width: 17px;
    height: 17px;
    right: 5px;
    top: 0px;
    bottom: 0px;
    margin-top: auto;
    margin-bottom: auto;
    line-height: 0;
    opacity: 1;
    transition: opacity 0.25s ease;
  }
  
  .js-toggle--checked .js-toggle-track-x {
    opacity: 0;
  }
  
  .js-toggle-thumb {
    position: absolute;
    top: 1px;
    left: 1px;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background-color: #fafafa;
    box-sizing: border-box;
    transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1) 0ms;
    transform: translateX(0);
  }
  
  .js-toggle--checked .js-toggle-thumb {
    transform: translateX(26px);
    border-color: #19ab27;
  }
  
  .js-toggle--focus .js-toggle-thumb {
    box-shadow: 0px 0px 2px 3px rgb(255, 167, 196);
  }
  
  .js-toggle:active .js-toggle-thumb {
    box-shadow: 0px 0px 5px 5px rgb(255, 167, 196);
  }
  
  body.dark-mode , 
  body.dark-mode main * {
    background-color: #000000;
    color: #000000;
    filter: invert(0.95);
}

  .dark-mode img {
  filter: invert(1) contrast(1.3) saturate(1.4);
}

  .dark-mode p {
  color: #000000;
}
  
  .dark-mode code {
    filter: invert(1) contrast(1.3) saturate(1.4);
    font-weight: bold;
    background: #353737;
    color: white;
}

  .dark-mode strong, b {
    filter: invert(1) contrast(1.3) saturate(1.4);
  }
  
  .dark-mode #social-share ul{
    margin: 0;
    filter: invert(1) contrast(1.3) saturate(1.4);
  }

  .dark-mode #header {
    filter: invert(1) contrast(1.3) saturate(1.4);
    position: fixed;
  }

  .dark-mode .js-toggle--focus .js-toggle-thumb {
    filter: invert(1) contrast(1.3) saturate(1.4);
  }

  .dark-mode .footer {
    filter: invert(1) contrast(1.3) saturate(1.4);
    position: fixed;
    background-color: white;
    font-weight: bold;
  }

  .dark-mode .nav-secondary {
    filter: invert(1) contrast(1.3) saturate(1.4);
}

  .dark-mode #reactions .reaction-items .reaction-item .reaction-item__button img, #reactions-promotion .reaction-items .reaction-item .reaction-item__button img {
    filter: invert(1) contrast(1.3) saturate(1.4);
}

</style>

<script>
    var body = document.body;
    var article = document.article;
	var switcher = document.getElementsByClassName('js-toggle')[0];

	
	switcher.addEventListener("click", function() {
        this.classList.toggle('js-toggle--checked');
        this.classList.add('js-toggle--focus');
		
		if (this.classList.contains('js-toggle--checked')) {
			body.classList.add('dark-mode');
			article.classList.add('post.dark-mode');
			
			localStorage.setItem('darkMode', 'true');
		} else {
			body.classList.remove('dark-mode');
			article.classList.remove('post.dark-mode');
			setTimeout(function() {
				localStorage.removeItem('darkMode');
			}, 100);
		}
	})

	
	if (localStorage.getItem('darkMode')) {
		
        switcher.classList.add('js-toggle--checked');
        body.classList.add('dark-mode');
        article.classList.add('post.dark-mode');
	}

</script>


      
        <script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "https:\/\/algotech.netlify.com\/"
        },
        "articleSection" : "blog",
        "name" : "Creating Choropleth with Mapshaper and R",
        "headline" : "Creating Choropleth with Mapshaper and R",
        "description" : "Geospatial is one of the important things in data processing. With geospatial, we can provide information only with the help of maps so that information can be conveyed properly.\nThere are many types of geospatial that we can do, such as Dot Map, Connection Map, Choropleth, Hexbin Map, and Bubble Map1. Each type of geospatial has its own function, and each of these types also requires different types of information\/data.",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2019",
        "datePublished": "2019-08-18 00:00:00 \u002b0000 UTC",
        "dateModified" : "2019-08-18 00:00:00 \u002b0000 UTC",
        "url" : "https:\/\/algotech.netlify.com\/blog\/creating-choropleth-with-mapshaper-and-r\/",
        "wordCount" : "2612",
        "keywords" : [ "Geocoding","Mapshaper","Leaflet","Map","Data Visualization","Blog" ]
    }
    </script>
        
            
                <title>Creating Choropleth with Mapshaper and R</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content="Hugo 0.87.0" />
        
  
    
  

  

  <link rel="apple-touch-icon-precomposed" href='https://algotech.netlify.com/favicon/apple-touch-icon-precomposed.png'>
  <link rel="icon" href='https://algotech.netlify.com/favicon/favicon.png'>
  
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content='/favicon/mstile.png'>
  <meta name="application-name" content="Algoritma Technical Blog">
  <meta name="msapplication-tooltip" content="To learn more about our approach to data science problems, feel free to hop over to our blog.">
  <meta name="msapplication-config" content='/favicon/ieconfig.xml'>



        
            <meta name="author" content="Ardhito Utomo">
        
        
            
                <meta name="description" content="To learn more about our approach to data science problems, feel free to hop over to our blog.">
            
        

        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Creating Choropleth with Mapshaper and R"/>
<meta name="twitter:description" content="Geospatial is one of the important things in data processing. With geospatial, we can provide information only with the help of maps so that information can be conveyed properly.
There are many types of geospatial that we can do, such as Dot Map, Connection Map, Choropleth, Hexbin Map, and Bubble Map1. Each type of geospatial has its own function, and each of these types also requires different types of information/data."/>
<meta name="twitter:site" content="@teamalgoritma"/>

        <meta property="og:title" content="Creating Choropleth with Mapshaper and R" />
<meta property="og:description" content="Geospatial is one of the important things in data processing. With geospatial, we can provide information only with the help of maps so that information can be conveyed properly.
There are many types of geospatial that we can do, such as Dot Map, Connection Map, Choropleth, Hexbin Map, and Bubble Map1. Each type of geospatial has its own function, and each of these types also requires different types of information/data." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://algotech.netlify.com/blog/creating-choropleth-with-mapshaper-and-r/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2019-08-18T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-08-18T00:00:00+00:00" />


        <meta property="og:image" content="https://algotech.netlify.com//images/logo.png">
        <meta property="og:image:type" content="image/png">
        <meta property="og:image:width" content="512">
        <meta property="og:image:height" content="512">
        <meta itemprop="name" content="Creating Choropleth with Mapshaper and R">
<meta itemprop="description" content="Geospatial is one of the important things in data processing. With geospatial, we can provide information only with the help of maps so that information can be conveyed properly.
There are many types of geospatial that we can do, such as Dot Map, Connection Map, Choropleth, Hexbin Map, and Bubble Map1. Each type of geospatial has its own function, and each of these types also requires different types of information/data."><meta itemprop="datePublished" content="2019-08-18T00:00:00+00:00" />
<meta itemprop="dateModified" content="2019-08-18T00:00:00+00:00" />
<meta itemprop="wordCount" content="2612">
<meta itemprop="keywords" content="Geocoding,Mapshaper,Leaflet,Map,Data Visualization," />
        

        
            
        

        
        
            <link disabled id="dark-mode-theme" rel="stylesheet" href="https://algotech.netlify.com/css/dark.css">
            <link rel="stylesheet" href="https://algotech.netlify.com/css/monokai-sublime.css">
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800,900|Source+Sans+Pro:400,700">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.css">
            <link rel="stylesheet" href="https://algotech.netlify.com/css/main.css">
            <link rel="stylesheet" href="https://algotech.netlify.com/css/add-on.css">
            <link rel="stylesheet" href="https://algotech.netlify.com/css/academicons.min.css">
            <link href="https://algotech.netlify.com/lib/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
            <link href="https://algotech.netlify.com/lib/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet">
            <link href="https://algotech.netlify.com/lib/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet">
            <link href="https://algotech.netlify.com/lib/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet">
        
            <link rel="stylesheet" href=
            "https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
                <link rel="stylesheet" href=
            "https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
                      integrity=
            "sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" 
                      crossorigin="anonymous">
                <script src=
            "https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js">
                </script>
                <script src=
            "https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js">
                </script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.1.0/js.cookie.js">
                </script>
                
                <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.0/jquery.cookie.min.js">
                </script>
              
                <style>
                    
                     


                    .modal:before {
                        content: '';
                        display: inline-block;
                        height: 20%;
                        vertical-align: middle;
                    }
                      
                    .modal-dialog {
                        
                    display: -webkit-box;
                    display: -webkit-flex;
                    display: -ms-flexbox;
                    display: flex;
                    -webkit-box-orient: vertical;
                    -webkit-box-direction: normal;
                    -webkit-flex-direction: column;
                        -ms-flex-direction: column;
                            flex-direction: column;
                    -webkit-box-pack: center;
                    -webkit-justify-content: center;
                        -ms-flex-pack: center;
                            justify-content: center;
                    }

                      
                    .modal .modal-content {
                        padding: 20px 20px 20px 20px;
                        -webkit-animation-name: modal-animation;
                        -webkit-animation-duration: 0.5s;
                        animation-name: modal-animation;
                        animation-duration: 1.5s;
                    }

                

                    .modal .leadin-button {
                        -webkit-border-radius: 0.25em;
                        -moz-border-radius: 0.25em;
                        -ms-border-radius: 0.25em;
                        -o-border-radius: 0.25em;
                        border-radius: 0.25em;
                        -webkit-appearance: none;
                        cursor: pointer;
                        font-size: 1em;
                        font-weight: bold;
                        line-height: 1;
                        padding: 1em 1.5em;
                        width: 100%;
                        text-decoration: none;
                    }
                    .modal .leadin-button-primary {
                        background: #a90606 !important;
                        color: #FFFFFF !important;
                    }
                      
                    @-webkit-keyframes modal-animation {
                        from {
                            top: -100px;
                            opacity: 0;
                        }
                        to {
                            top: 0px;
                            opacity: 1;
                        }
                    }
                      
                    @keyframes modal-animation {
                        from {
                            top: -100px;
                            opacity: 0;
                        }
                        to {
                            top: 0px;
                            opacity: 1;
                        }
                    }
                </style>

            <script src="content/bootstrapJS/jquery-2.1.1.min.js" type="text/javascript"></script>

            <script type="text/javascript">
                
                
                $( document ).ready(function() {
  if (document.cookie.indexOf('visited=true') == -1){
    
                      $('#signupModal').modal('show');
    
                  var year = 1000*60*60*24*365;
    var expires = new Date((new Date()).valueOf() + year);
    document.cookie = "visited=true;expires=" + expires.toUTCString();

  }
}); 

            </script>
        
            

        
            
                
            
                
                    <link rel="stylesheet" href="https://algotech.netlify.com/css/main.css">
                
            
        


  
    
      <link rel="stylesheet" href="https://algotech.netlify.com/css/monokai-sublime.css" rel="stylesheet" id="theme-stylesheet">
      <script src="https://algotech.netlify.com/js/highlight.pack.js"></script>
      <script>hljs.initHighlightingOnLoad();</script>
  


      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-164959107-2', 'auto');
	
	ga('send', 'pageview');
}
</script>



      
    </head>
    <body>

        <div class="modal" id="signupModal"
        role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
 
       <div class="modal-dialog">
           <div class="modal-content">
 
               
               <div class="m-header">
                   <button class="close" data-dismiss="modal">
                       ×
                   </button>
                   <h2 class="myModalLabel"> Upcoming Workshop! </h2>
               </div>
 
               
               <div class="inputs">
 
                <a href="https://algorit.ma/ds-course/dss-trading/?utm_source=algotech"><img src="https://algotech.netlify.com/img/2021/ads/dss-okt.png",
                     alt="Building Algorithmic Trading Dashboard", style="float: left; padding-right: 20px;" padding: 1px  width="30%" height="30%"></a>
                <p>This 3-day online workshop is a beginner-friendly introduction to algorithmic trading using the Python programming language. Throughout the online course, we will provide you with hands-on examples and a rich interactive experience. One Instructor and two Teaching Assistants will help you to troubleshoot or help with any difficulties encountered.</p>
                <div class="advance-wrapper callout-special-font">
                    <a href="https://algorit.ma/ds-course/dss-trading/?utm_source=algotech" target="_blank" 
                    class="leadin-button leadin-advance-button leadin-button-primary">LEARN MORE</a>
                </div>
               </div>
 
 
           </div>
       </div>
   </div>

    </body>

      
      <div id="wrapper">

    
    
<header id="header">
    
      <h1><a href="https://algotech.netlify.com/">blog</a></h1>
    

    <nav class="links">
        <ul>
            
                <li>
                    <a href="https://algotech.netlify.com/">
                            <i class="fa fa-home">&nbsp;</i>Home
                    </a>
                </li>
            
                <li>
                    <a href="https://algotech.netlify.com/tags/machine-learning/">
                            <i class="fa fa-cog">&nbsp;</i>Machine Learning
                    </a>
                </li>
            
                <li>
                    <a href="https://algotech.netlify.com/tags/data-visualization/">
                            <i class="fa fa-area-chart">&nbsp;</i>Data Visualization
                    </a>
                </li>
            
                <li>
                    <a href="https://algotech.netlify.com/tags/">
                            <i class="fa fa-list">&nbsp;</i>Article List
                    </a>
                </li>
            
        </ul>
    </nav>
    <nav class="main">
        <ul>
            
            <li id="share-nav" class="share-menu" style="display:none;">
                <a class="fa-share-alt" href="#share-menu">Share</a>
            </li>
            
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="//google.com/search">
                    <input type="text" name="q" placeholder="Search" />
                    <input type="hidden" name="as_sitesearch" value="https://algotech.netlify.com/">
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>


<section id="menu">

    
        <section>
            <form class="search" method="get" action="//google.com/search">
                <input type="text" name="q" placeholder="Search" />
                <input type="hidden" name="as_sitesearch" value="https://algotech.netlify.com/">
            </form>
        </section>

    
        <section>
            <ul class="links">
                
                    <li>
                        <a href="https://algotech.netlify.com/">
                            <h3>
                                <i class="fa fa-home">&nbsp;</i>Home
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://algotech.netlify.com/tags/machine-learning/">
                            <h3>
                                <i class="fa fa-cog">&nbsp;</i>Machine Learning
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://algotech.netlify.com/tags/data-visualization/">
                            <h3>
                                <i class="fa fa-area-chart">&nbsp;</i>Data Visualization
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://algotech.netlify.com/tags/">
                            <h3>
                                <i class="fa fa-list">&nbsp;</i>Article List
                            </h3>
                        </a>
                    </li>
                
            </ul>
        </section>

    
        <section class="recent-posts">
            <div class="mini-posts">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                

                
                    
                

                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://algotech.netlify.com/blog/regression-arima-arimax/">Regression ARIMA (ARIMAX)</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-09-09'>
                                    September 9, 2021</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://algotech.netlify.com/blog/hotel-forecast/">Multiple Hotel Segments Demand Forecasting</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-07-30'>
                                    July 30, 2021</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://algotech.netlify.com/blog/advancing-your-shinyapp-ii/">Advancing Your Shiny Application II</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-06-03'>
                                    June 3, 2021</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://algotech.netlify.com/blog/gridsearchcv/">GridSearchCV</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-05-22'>
                                    May 22, 2021</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://algotech.netlify.com/blog/kemiripan-teks/">Pengenalan Kemiripan Teks (Text Similarity) di Python</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-05-20'>
                                    May 20, 2021</time>
                            </header>
                            

                        </article>
                

                
                    <a href=
                        
                            /blog/
                        
                        class="button">View more posts</a>
                
            </div>
        </section>

    
        
</section>

    <section id="share-menu">
    <section id="social-share-nav">
        <ul class="links">
            <header>
                <h3>Share this post <i class="fa fa-smile-o"></i></h3>
            </header>
            



<li>
  <a href="https://twitter.com/intent/tweet?text=Creating%20Choropleth%20with%20Mapshaper%20and%20R by Ardhito%20Utomo&amp;url=https%3a%2f%2falgotech.netlify.com%2fblog%2fcreating-choropleth-with-mapshaper-and-r%2f" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>








<li>
  <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2falgotech.netlify.com%2fblog%2fcreating-choropleth-with-mapshaper-and-r%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
    </a>
</li>







<li>
  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2falgotech.netlify.com%2fblog%2fcreating-choropleth-with-mapshaper-and-r%2f&amp;title=Creating%20Choropleth%20with%20Mapshaper%20and%20R" target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>











        </ul>
    </section>
</section>

    
    <div id="main">
        
        
        <article class="post">
  <header>
    <div class="title">
        
            <h2><a href="https://algotech.netlify.com/blog/creating-choropleth-with-mapshaper-and-r/">Creating Choropleth with Mapshaper and R</a></h2>
        
        
    </div>
    <div class="meta">
        

        <time class="published"
            datetime='2019-08-18'>
            August 18, 2019</time>
        <span class="author"><a href="https://github.com/ardhitoutomo">Ardhito Utomo</a></span>
        
            <p>13 minute read</p>
        
        
    </div>
</header>


  
    <section id="social-share">
      <ul class="icons">
        



<li>
  <a href="https://twitter.com/intent/tweet?text=Creating%20Choropleth%20with%20Mapshaper%20and%20R by Ardhito%20Utomo&amp;url=https%3a%2f%2falgotech.netlify.com%2fblog%2fcreating-choropleth-with-mapshaper-and-r%2f" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>








<li>
  <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2falgotech.netlify.com%2fblog%2fcreating-choropleth-with-mapshaper-and-r%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
    </a>
</li>







<li>
  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2falgotech.netlify.com%2fblog%2fcreating-choropleth-with-mapshaper-and-r%2f&amp;title=Creating%20Choropleth%20with%20Mapshaper%20and%20R" target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>











      </ul>
    </section>
  

  
    

    
        
        







  
  
    
  


        
        
        

        <a href="https://algotech.netlify.com/blog/creating-choropleth-with-mapshaper-and-r/" class="image featured">
            <img src="https://algotech.netlify.com/img/2019/08/banner_choropleth.jpg" alt="">
        </a>
    


  <div id="content">
    <p><em>Geospatial</em> is one of the important things in data processing. With <em>geospatial</em>, we can provide information only with the help of maps so that information can be conveyed properly.</p>
<p>There are many types of <em>geospatial</em> that we can do, such as <em>Dot Map</em>, <em>Connection Map</em>, <em>Choropleth</em>, <em>Hexbin Map</em>, and <em>Bubble Map</em><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>. Each type of geospatial has its own function, and each of these types also requires different types of information/data.</p>
<p>This time, we will learn about one form of geocoding which is <strong>choropleth</strong>. Our pursuit of this material:</p>
<ul>
<li>Retrieving Data
<ul>
<li>Using <strong>Shapefile</strong>
<ul>
<li>Types of data used</li>
<li>Introduction to <strong>mapshaper</strong></li>
<li>Choose the data you want to focus on</li>
<li>Reading <code>.json</code> data</li>
</ul>
</li>
<li>Using <code>.rds</code></li>
</ul>
</li>
<li>Processing Data
<ul>
<li>Hydrant Data</li>
<li>Data Merge</li>
</ul>
</li>
<li>Presenting Data with <code>leaflet</code></li>
</ul>
<h2 id="retrieving-data">Retrieving Data</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">library</span>(prettydoc)
<span style="color:#a6e22e">library</span>(tidyverse)
<span style="color:#a6e22e">library</span>(ggplot2)
<span style="color:#a6e22e">library</span>(leaflet)
<span style="color:#a6e22e">library</span>(geojsonio)
<span style="color:#a6e22e">library</span>(htmlwidgets)
<span style="color:#a6e22e">library</span>(htmltools)
</code></pre></div><p>First of all, we would like to download the data from [GADM] (<a href="https://gadm.org/download_country_v3.html)">https://gadm.org/download_country_v3.html)</a>. We will focus on <strong>Indonesia</strong>. In data retrieval, there are two ways we can do it: process the file as a Shapefile data type first, or directly process it using R with <code>.rds</code> data. We could also read the entire data using the <code>readOGR</code> function from the <code>rgdal</code> package, but we won&rsquo;t discuss that this time.</p>
<h3 id="shapefile-data">Shapefile Data</h3>
<p>Shapefile data is a collection of data used in many <em>geospatial</em> applications. The advantage of Shapefile data is that besides being accessible in many map processing applications, Shapefile data can also be viewed and processed in <strong>mapshaper</strong> (we will discuss it after this) to ensure the information in it before extracting it as the file we need.</p>
<p>When we look at Shapefile data (<code>.shp</code>) that we have downloaded from GADM, we can see that each section is divided into several files at once <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>:</p>
<ul>
<li><code>.shp</code>: main data containing geometry information (main)</li>
<li><code>.shx</code>: index file of each geometry (main)</li>
<li><code>.dbf</code>: data that contains attributes in each area in the data (main)</li>
<li><code>.prj</code>: file that stores coordinate system information (optional, used in ArcGIS)</li>
<li><code>.cpg</code>: file used to specify the <em>code page</em> to identify the character set used (optional)</li>
</ul>
<p>Because the information that we use is spread to several files at once with different extensions, we have to change it first to one file so that it is more easily accessed/processed in R. For this reason, we will process it first in <a href="https://mapshaper.org/">mapshaper</a>. After some processing and cleaning, we can extract the data in the form of <code>.json</code>.</p>
<!-- raw HTML omitted -->
<p>Mapshaper will receive some data and collect it at once. From all 5 extensions we from shapefiles, we can put everything except <code>.cpg</code>. We set everything up, we click on the <em>detect intersection path</em> section to confirm whether our data have any <em>intersection</em>/<em>contact point</em> or not, then we <em>import</em>.</p>
<!-- raw HTML omitted -->
<p>From the results we have imported, we can see that the <code>gadm36_IDN_3</code> data is the data that cuts across the district. In this data, it also happens that the map we get is a &lsquo;good&rsquo; map, because there is no <em>meeting point</em>/<em>intersection</em><sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>After that, we would want to see all information about each area that we have from the data we have imported, by pressing the <code>i</code> button on the top right. We can see that there is information about the country (in the variable <code>NAME_0</code>), provinces (<code> NAME_1</code>), districts/cities (<code>NAME_2</code>), sub-districts (<code> NAME_3</code>), also villages (<code>NAME_4</code>) of each place. In addition, there are IDs for each section, but we will not use them here.</p>
<p>We can directly export it in the form of TopoJSON (similar if not lighter than GeoJSON, and we can use this because our data is clean enough <sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>). But for now, we will try to select/filter the areas we want to focus on.</p>
<p>In the mapshaper, there is a <em>console</em> that we can use to process map data. We can see commands that we can use with <code>help</code> and see some examples of using console with <code>tips</code>.</p>
<p>We will try to select only in the sub-district (<code>gadm36_IDN_3</code>) and we filter only on the DKI Jakarta area:</p>
<pre><code>filter 'NAME_1 == &quot;Jakarta Raya&quot;'
</code></pre><!-- raw HTML omitted -->
<p>After that, we will export the data as TopoJSON by clicking &lsquo;Export&rsquo; at the top right.</p>
<p>Then, to read the <code>.json</code> data in R, we will use the <code>geojsonio</code> package. In the <code>geojson_read</code> function, we specify <code>what = &quot;sp&quot;</code> to make sure the data we read is a spatial class, not <em>list</em>. Due to the data we have from different sources and differences in the &ldquo;Pulau Seribu&rdquo; section (vs. &ldquo;Kep. Seribu&rdquo;), we will omit that section.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># Read the data</span>
jakarta_json <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">geojson_read</span>(<span style="color:#e6db74">&#34;data_input/clean/gadm36_IDN_3_jkt.json&#34;</span>, what <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sp&#34;</span>)
</code></pre></div><p>If you want to check the data first, you can use <code>@</code> to see the contents of the table</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">head</span>(jakarta_json<span style="color:#f92672">@</span>data)
</code></pre></div><pre><code>#&gt;     id GID_0    NAME_0   GID_1       NAME_1 NL_NAME_1     GID_2        NAME_2
#&gt; 1 &lt;NA&gt;   IDN Indonesia IDN.7_1 Jakarta Raya           IDN.7.1_1 Jakarta Barat
#&gt; 2 &lt;NA&gt;   IDN Indonesia IDN.7_1 Jakarta Raya           IDN.7.1_1 Jakarta Barat
#&gt; 3 &lt;NA&gt;   IDN Indonesia IDN.7_1 Jakarta Raya           IDN.7.1_1 Jakarta Barat
#&gt; 4 &lt;NA&gt;   IDN Indonesia IDN.7_1 Jakarta Raya           IDN.7.1_1 Jakarta Barat
#&gt; 5 &lt;NA&gt;   IDN Indonesia IDN.7_1 Jakarta Raya           IDN.7.1_1 Jakarta Barat
#&gt; 6 &lt;NA&gt;   IDN Indonesia IDN.7_1 Jakarta Raya           IDN.7.1_1 Jakarta Barat
#&gt;   NL_NAME_2       GID_3           NAME_3 VARNAME_3 NL_NAME_3    TYPE_3
#&gt; 1           IDN.7.1.1_1       Cengkareng                     Kecamatan
#&gt; 2           IDN.7.1.2_1 Grogolpetamburan                     Kecamatan
#&gt; 3           IDN.7.1.3_1        Kalideres                     Kecamatan
#&gt; 4           IDN.7.1.4_1       Kebonjeruk                     Kecamatan
#&gt; 5           IDN.7.1.5_1        Kembangan                     Kecamatan
#&gt; 6           IDN.7.1.6_1         Palmerah                     Kecamatan
#&gt;      ENGTYPE_3    CC_3 HASC_3
#&gt; 1 Sub-district 3174070       
#&gt; 2 Sub-district 3174040       
#&gt; 3 Sub-district 3174080       
#&gt; 4 Sub-district 3174020       
#&gt; 5 Sub-district 3174010       
#&gt; 6 Sub-district 3174030
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># Change the data type to `sf`</span>
jakarta_json_mod <span style="color:#f92672">&lt;-</span> sf<span style="color:#f92672">::</span><span style="color:#a6e22e">st_as_sf</span>(jakarta_json)

<span style="color:#75715e"># Removing `Kepulauan Seribu` and some columns we won&#39;t use </span>
jakarta_json_mod <span style="color:#f92672">&lt;-</span> jakarta_json_mod <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#75715e"># Change the name as template</span>
  <span style="color:#a6e22e">mutate</span>(NAME_3 <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_replace_all</span>(NAME_3, <span style="color:#a6e22e">fixed</span>(<span style="color:#e6db74">&#34; &#34;</span>), <span style="color:#e6db74">&#34;&#34;</span>) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">str_to_title</span>()) <span style="color:#f92672">%&gt;%</span>       
  <span style="color:#75715e"># Removing `Kepulauan Seribu`</span>
  <span style="color:#a6e22e">filter</span>(NAME_2 <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;Kepulauan Seribu&#34;</span>)  <span style="color:#f92672">%&gt;%</span>                        
  <span style="color:#75715e"># Removing some columns</span>
  dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">select</span>(<span style="color:#f92672">-</span><span style="color:#a6e22e">c</span>(id, NL_NAME_1, NL_NAME_2, NL_NAME_3, VARNAME_3, HASC_3, TYPE_3, ENGTYPE_3)) 

<span style="color:#a6e22e">glimpse</span>(jakarta_json_mod)
</code></pre></div><pre><code>#&gt; Observations: 45
#&gt; Variables: 10
#&gt; $ GID_0    &lt;chr&gt; &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;I...
#&gt; $ NAME_0   &lt;chr&gt; &quot;Indonesia&quot;, &quot;Indonesia&quot;, &quot;Indonesia&quot;, &quot;Indonesia&quot;, &quot;Indon...
#&gt; $ GID_1    &lt;chr&gt; &quot;IDN.7_1&quot;, &quot;IDN.7_1&quot;, &quot;IDN.7_1&quot;, &quot;IDN.7_1&quot;, &quot;IDN.7_1&quot;, &quot;ID...
#&gt; $ NAME_1   &lt;chr&gt; &quot;Jakarta Raya&quot;, &quot;Jakarta Raya&quot;, &quot;Jakarta Raya&quot;, &quot;Jakarta R...
#&gt; $ GID_2    &lt;chr&gt; &quot;IDN.7.1_1&quot;, &quot;IDN.7.1_1&quot;, &quot;IDN.7.1_1&quot;, &quot;IDN.7.1_1&quot;, &quot;IDN.7...
#&gt; $ NAME_2   &lt;chr&gt; &quot;Jakarta Barat&quot;, &quot;Jakarta Barat&quot;, &quot;Jakarta Barat&quot;, &quot;Jakart...
#&gt; $ GID_3    &lt;chr&gt; &quot;IDN.7.1.1_1&quot;, &quot;IDN.7.1.2_1&quot;, &quot;IDN.7.1.3_1&quot;, &quot;IDN.7.1.4_1&quot;...
#&gt; $ NAME_3   &lt;chr&gt; &quot;Cengkareng&quot;, &quot;Grogolpetamburan&quot;, &quot;Kalideres&quot;, &quot;Kebonjeruk...
#&gt; $ CC_3     &lt;chr&gt; &quot;3174070&quot;, &quot;3174040&quot;, &quot;3174080&quot;, &quot;3174020&quot;, &quot;3174010&quot;, &quot;31...
#&gt; $ geometry &lt;MULTIPOLYGON&gt; MULTIPOLYGON (((106.7004 -6..., MULTIPOLYGON (((1...
</code></pre><h3 id="data-rds">Data <code>.rds</code></h3>
<p>For <code>.rds</code> data, we can directly select <code>R(sf)</code> in GADM<sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup>. After that, we can immediately read it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">indonesia_rds <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read_rds</span>(<span style="color:#e6db74">&#34;data_input/clean/gadm36_IDN_3_sf.rds&#34;</span>)
</code></pre></div><p>Then because we want to focus on DKI Jakarta, we will process the data first</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">jakarta_rds <span style="color:#f92672">&lt;-</span> indonesia_rds <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(NAME_3 <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_replace_all</span>(NAME_3, <span style="color:#a6e22e">fixed</span>(<span style="color:#e6db74">&#34; &#34;</span>), <span style="color:#e6db74">&#34;&#34;</span>) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">str_to_title</span>()) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">filter</span>(NAME_1 <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Jakarta Raya&#34;</span>, NAME_2 <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;Kepulauan Seribu&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">select</span>(<span style="color:#f92672">-</span><span style="color:#a6e22e">c</span>(NL_NAME_1, NL_NAME_2, NL_NAME_3, VARNAME_3, HASC_3, TYPE_3, ENGTYPE_3))

<span style="color:#a6e22e">glimpse</span>(jakarta_rds)
</code></pre></div><pre><code>#&gt; Observations: 45
#&gt; Variables: 10
#&gt; $ GID_0    &lt;chr&gt; &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;I...
#&gt; $ NAME_0   &lt;chr&gt; &quot;Indonesia&quot;, &quot;Indonesia&quot;, &quot;Indonesia&quot;, &quot;Indonesia&quot;, &quot;Indon...
#&gt; $ GID_1    &lt;chr&gt; &quot;IDN.7_1&quot;, &quot;IDN.7_1&quot;, &quot;IDN.7_1&quot;, &quot;IDN.7_1&quot;, &quot;IDN.7_1&quot;, &quot;ID...
#&gt; $ NAME_1   &lt;chr&gt; &quot;Jakarta Raya&quot;, &quot;Jakarta Raya&quot;, &quot;Jakarta Raya&quot;, &quot;Jakarta R...
#&gt; $ GID_2    &lt;chr&gt; &quot;IDN.7.1_1&quot;, &quot;IDN.7.1_1&quot;, &quot;IDN.7.1_1&quot;, &quot;IDN.7.1_1&quot;, &quot;IDN.7...
#&gt; $ NAME_2   &lt;chr&gt; &quot;Jakarta Barat&quot;, &quot;Jakarta Barat&quot;, &quot;Jakarta Barat&quot;, &quot;Jakart...
#&gt; $ GID_3    &lt;chr&gt; &quot;IDN.7.1.1_1&quot;, &quot;IDN.7.1.2_1&quot;, &quot;IDN.7.1.3_1&quot;, &quot;IDN.7.1.4_1&quot;...
#&gt; $ NAME_3   &lt;chr&gt; &quot;Cengkareng&quot;, &quot;Grogolpetamburan&quot;, &quot;Kalideres&quot;, &quot;Kebonjeruk...
#&gt; $ CC_3     &lt;chr&gt; &quot;3174070&quot;, &quot;3174040&quot;, &quot;3174080&quot;, &quot;3174020&quot;, &quot;3174010&quot;, &quot;31...
#&gt; $ geometry &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((106.7004 -6..., MULTIPOLYGON ...
</code></pre><p>We can see that both data already contain the same information and with the same class. Please note that the next time we use <code>leaflet</code>, one of the data type they can read is spatial data frames from package <code>lf</code> (see <code>?leaflet</code> for further details).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">class</span>(jakarta_rds)
</code></pre></div><pre><code>#&gt; [1] &quot;sf&quot;         &quot;data.frame&quot;
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">class</span>(jakarta_json_mod)
</code></pre></div><pre><code>#&gt; [1] &quot;sf&quot;         &quot;data.frame&quot;
</code></pre><p>We can continue to use one of the data we have read previously. This time, we will use the data that had been read earlier through mapshaper (<code>jakarta_json_mod</code>).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">rm</span>(indonesia_rds, jakarta_rds)
</code></pre></div><h2 id="processing-the-data">Processing The Data</h2>
<p>In the data processing stage, we will try to match the contents of the hydrant data which we will later display the information on the map, with the geometry data that have previously read (and processed). This is done to avoid clashes due to different regional names, and it also more reasonable to do so.</p>
<h3 id="hydrant-data">Hydrant Data</h3>
<p>We will read the hydrant data which contains information about the hydrants scattered in the Greater Jakarta area along with the conditions (Good/Damaged/Missing) and the location name of the area (<strong>not</strong> the location of the hydrant).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">hidran <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read.csv</span>(<span style="color:#e6db74">&#34;data_input/clean/hidran.csv&#34;</span>)

hidran_mod <span style="color:#f92672">&lt;-</span> hidran <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(lokasi <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_replace_all</span>(lokasi, <span style="color:#a6e22e">fixed</span>(<span style="color:#e6db74">&#34; &#34;</span>), <span style="color:#e6db74">&#34;&#34;</span>) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">str_to_title</span>()) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(wilayah <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;Kepulauan Seribu&#34;</span>) 

<span style="color:#a6e22e">head</span>(hidran_mod)
</code></pre></div><pre><code>#&gt;   no       wilayah       lokasi kondisi jumlah  latitude longitude
#&gt; 1  1 Jakarta Pusat       Gambir    Baik     20 -6.169115  106.8165
#&gt; 2  2 Jakarta Pusat   Tanahabang    Baik     36 -6.206441  106.8122
#&gt; 3  3 Jakarta Pusat      Menteng    Baik     30 -6.195425  106.8346
#&gt; 4  4 Jakarta Pusat    Joharbaru    Baik     15 -6.185153  106.8575
#&gt; 5  5 Jakarta Pusat Cempakaputih    Baik     21 -6.180330  106.8687
#&gt; 6  6 Jakarta Pusat    Kemayoran    Baik     34 -6.160978  106.8533
</code></pre><p>There are several other modifications that will be made:</p>
<ul>
<li>The condition &ldquo;Lost&rdquo;/&ldquo;Hilang&rdquo; will be replaced by &ldquo;Damaged&rdquo;/&ldquo;Rusak&rdquo; due to the &ldquo;Hilang&rdquo; factor gives very little or no contribution to the data</li>
<li>Conditions/&ldquo;kondisi&rdquo; will be added by region and location again so that the level from the original &ldquo;Rusak&rdquo; and &ldquo;Rusak&rdquo; from &ldquo;Hilang&rdquo; can be combined into one factor only</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">hidran_mod <span style="color:#f92672">&lt;-</span> hidran_mod <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(kondisi <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(kondisi <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Hilang&#34;</span>, <span style="color:#e6db74">&#34;Rusak&#34;</span>, <span style="color:#a6e22e">paste</span>(kondisi))) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">group_by</span>(wilayah, lokasi, kondisi) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">summarise</span>(jumlah <span style="color:#f92672">=</span> <span style="color:#a6e22e">sum</span>(jumlah)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ungroup</span>()

<span style="color:#a6e22e">glimpse</span>(hidran_mod)
</code></pre></div><pre><code>#&gt; Observations: 82
#&gt; Variables: 4
#&gt; $ wilayah &lt;fct&gt; Jakarta Barat, Jakarta Barat, Jakarta Barat, Jakarta Barat,...
#&gt; $ lokasi  &lt;chr&gt; &quot;Cengkareng&quot;, &quot;Cengkareng&quot;, &quot;Grogolpetamburan&quot;, &quot;Grogolpeta...
#&gt; $ kondisi &lt;chr&gt; &quot;Baik&quot;, &quot;Rusak&quot;, &quot;Baik&quot;, &quot;Rusak&quot;, &quot;Baik&quot;, &quot;Rusak&quot;, &quot;Baik&quot;, ...
#&gt; $ jumlah  &lt;int&gt; 13, 1, 21, 4, 3, 3, 5, 2, 36, 7, 7, 7, 7, 7, 21, 10, 20, 9,...
</code></pre><h3 id="combining-data">Combining Data</h3>
<p>In merging data, there are several things that we&rsquo;ll do:</p>
<ul>
<li>Combining the <code>json</code> data we have with the <code>hydrant</code> data, where <code>NAME_2</code> in the <code>json</code> data will be paired with <code>territory</code>/<code>wilayah</code> in the <code>hydrant</code> data, and <code>NAME_3</code> with <code>location</code>/<code>lokasi</code></li>
<li>Performs the <code>complete</code> function to fill <code>kondisi</code>(<code>Baik</code>/<code>Rusak</code>) in areas not previously listed in the <code>hydrant</code> data</li>
<li>Sort the data to then fill in the <code>NA</code> values</li>
<li>Use the <code>fill</code> function from <code>tidyr</code> to fill missing values <strong>except</strong> the <code>amount</code>/<code>jumlah</code> and <code>kondisi</code> column, in a downward direction. We do this because there are conditions when we have geometric data but do not have a <code>jumlah</code> for each <code>kondisi</code>, and vice versa. By doing this, we will get complete information on each column except <code>jumlah</code>, <code>geometry</code>, and <code>kondisi</code> only</li>
<li>Fill in the value in the <code>geometry</code> column using looping function. Here the <code>lengths</code> function is used which returns whether a list has contents or not. If it is empty, it will be filled with a list above it (using the <code>list.take</code> function from the <code>rlist</code> library and taking the list to <code>[i-1]</code> or one row above)</li>
<li>Replacing the value of <code>NA</code> in <code>jumlah</code> with <code>0</code></li>
<li>Removes lines with <code>kondisi == NA</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">jakarta_hidran <span style="color:#f92672">&lt;-</span> jakarta_json_mod <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">left_join</span>(hidran_mod, by <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;NAME_2&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;wilayah&#34;</span>, <span style="color:#e6db74">&#34;NAME_3&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lokasi&#34;</span>)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">complete</span>(kondisi, NAME_3) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">arrange</span>(NAME_3, NAME_0) <span style="color:#f92672">%&gt;%</span> 
  tidyr<span style="color:#f92672">::</span><span style="color:#a6e22e">fill</span>(<span style="color:#f92672">-</span><span style="color:#a6e22e">c</span>(jumlah, kondisi), .direction <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;down&#34;</span>) 

<span style="color:#75715e"># Create a looping function to fill empty row in `geometri` column</span>
<span style="color:#a6e22e">for </span>(i in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#a6e22e">nrow</span>(jakarta_hidran)) {
  jakarta_hidran<span style="color:#f92672">$</span>geometry[i] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ifelse</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">lengths</span>(jakarta_hidran<span style="color:#f92672">$</span>geometry[i]), 
                                    rlist<span style="color:#f92672">::</span><span style="color:#a6e22e">list.take</span>(jakarta_hidran<span style="color:#f92672">$</span>geometry[i<span style="color:#ae81ff">-1</span>], n <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>), 
                                    jakarta_hidran<span style="color:#f92672">$</span>geometry[i])
}

jakarta_hidran <span style="color:#f92672">&lt;-</span> jakarta_hidran <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(jumlah <span style="color:#f92672">=</span> <span style="color:#a6e22e">replace_na</span>(jumlah, replace <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">na.omit</span>()

<span style="color:#a6e22e">glimpse</span>(jakarta_hidran)
</code></pre></div><pre><code>#&gt; Observations: 90
#&gt; Variables: 12
#&gt; $ kondisi  &lt;chr&gt; &quot;Baik&quot;, &quot;Rusak&quot;, &quot;Baik&quot;, &quot;Rusak&quot;, &quot;Baik&quot;, &quot;Rusak&quot;, &quot;Baik&quot;,...
#&gt; $ NAME_3   &lt;chr&gt; &quot;Cakung&quot;, &quot;Cakung&quot;, &quot;Cempakaputih&quot;, &quot;Cempakaputih&quot;, &quot;Cengk...
#&gt; $ GID_0    &lt;chr&gt; &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;IDN&quot;, &quot;I...
#&gt; $ NAME_0   &lt;chr&gt; &quot;Indonesia&quot;, &quot;Indonesia&quot;, &quot;Indonesia&quot;, &quot;Indonesia&quot;, &quot;Indon...
#&gt; $ GID_1    &lt;chr&gt; &quot;IDN.7_1&quot;, &quot;IDN.7_1&quot;, &quot;IDN.7_1&quot;, &quot;IDN.7_1&quot;, &quot;IDN.7_1&quot;, &quot;ID...
#&gt; $ NAME_1   &lt;chr&gt; &quot;Jakarta Raya&quot;, &quot;Jakarta Raya&quot;, &quot;Jakarta Raya&quot;, &quot;Jakarta R...
#&gt; $ GID_2    &lt;chr&gt; &quot;IDN.7.4_1&quot;, &quot;IDN.7.4_1&quot;, &quot;IDN.7.2_1&quot;, &quot;IDN.7.2_1&quot;, &quot;IDN.7...
#&gt; $ NAME_2   &lt;chr&gt; &quot;Jakarta Timur&quot;, &quot;Jakarta Timur&quot;, &quot;Jakarta Pusat&quot;, &quot;Jakart...
#&gt; $ GID_3    &lt;chr&gt; &quot;IDN.7.4.1_1&quot;, &quot;IDN.7.4.1_1&quot;, &quot;IDN.7.2.1_1&quot;, &quot;IDN.7.2.1_1&quot;...
#&gt; $ CC_3     &lt;chr&gt; &quot;3172080&quot;, &quot;3172080&quot;, &quot;3173050&quot;, &quot;3173050&quot;, &quot;3174070&quot;, &quot;31...
#&gt; $ jumlah   &lt;dbl&gt; 51, 12, 21, 10, 13, 1, 10, 16, 57, 9, 0, 0, 16, 1, 0, 0, 9...
#&gt; $ geometry &lt;MULTIPOLYGON&gt; MULTIPOLYGON (((106.9508 -6..., MULTIPOLYGON (((1...
</code></pre><p>When we do a simple <code>leaflet</code> mapping using <code>jakarta_hidran</code> data, we get an error like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">leaflet</span>(jakarta_hidran) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">addTiles</span>() <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">addPolygons</span>()
</code></pre></div><pre><code>#&gt; Error in polygonData.default(data): Don't know how to get path data from object of class tbl_df
</code></pre><p>This is because when we perform the <code>complete</code> function, our data will be converted into<code> tbl_df</code> data type, and this type is not accepted by <code>leaflet</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">class</span>(jakarta_hidran)
</code></pre></div><pre><code>#&gt; [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;
</code></pre><p>For that, we will change it back to <code>sf</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">jakarta_hidran_sf <span style="color:#f92672">&lt;-</span> jakarta_hidran <span style="color:#f92672">%&gt;%</span> sf<span style="color:#f92672">::</span><span style="color:#a6e22e">st_as_sf</span>()

<span style="color:#a6e22e">class</span>(jakarta_hidran_sf)
</code></pre></div><pre><code>#&gt; [1] &quot;sf&quot;         &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;
</code></pre><h2 id="showing-the-choropleth-using-leaflet">Showing the Choropleth using <code>leaflet</code></h2>
<p>In presenting data, we will first put our data into leaflet. Then, the appropriate coloring for <em>choropleth</em> will be formed. Palette is determined from red to blue (please see <em>cheatsheet</em> that has been provided). In addition, a popup is also made for each place.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># leaflet</span>
m <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">leaflet</span>(jakarta_hidran_sf)

<span style="color:#75715e"># Coloring</span>
temp_baik <span style="color:#f92672">&lt;-</span> jakarta_hidran_sf <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(kondisi <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Baik&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">select</span>(GID_3, NAME_3, jumlah)
temp_rusak <span style="color:#f92672">&lt;-</span> jakarta_hidran_sf <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(kondisi <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Rusak&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">select</span>(GID_3, NAME_3, jumlah) 

<span style="color:#75715e"># -1 &lt;= x &lt;= 1</span>
col_formula <span style="color:#f92672">&lt;-</span> (temp_baik<span style="color:#f92672">$</span>jumlah <span style="color:#f92672">-</span> temp_rusak<span style="color:#f92672">$</span>jumlah)<span style="color:#f92672">/</span>(temp_baik<span style="color:#f92672">$</span>jumlah <span style="color:#f92672">+</span> temp_rusak<span style="color:#f92672">$</span>jumlah) 
col <span style="color:#f92672">&lt;-</span> col_formula <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">replace</span>(<span style="color:#a6e22e">is.nan</span>(.), <span style="color:#ae81ff">0</span>)

bins <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-1</span>, <span style="color:#a6e22e">fivenum</span>(col))

pal <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">colorBin</span>(<span style="color:#e6db74">&#34;RdYlBu&#34;</span>, domain <span style="color:#f92672">=</span> col, bins <span style="color:#f92672">=</span> bins)

<span style="color:#75715e"># Popup</span>
popup.cont  <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">paste</span>(<span style="color:#e6db74">&#34;&lt;h2&gt;&lt;b&gt;&#34;</span>, jakarta_hidran_sf<span style="color:#f92672">$</span>NAME_3, <span style="color:#e6db74">&#34;&lt;/b&gt;&lt;/h2&gt;&#34;</span>,
   <span style="color:#e6db74">&#34;&lt;h4&gt;&lt;b&gt; Baik: &#34;</span>, temp_baik<span style="color:#f92672">$</span>jumlah, <span style="color:#e6db74">&#34;&lt;/h4&gt;&lt;/b&gt;&#34;</span>,
   <span style="color:#e6db74">&#34;&lt;h4&gt;&lt;b&gt; Rusak: &#34;</span>, temp_rusak<span style="color:#f92672">$</span>jumlah, <span style="color:#e6db74">&#34;&lt;/h4&gt;&lt;/b&gt;&#34;</span>
)
</code></pre></div><p>And finally, we will form a map with <em>tiles</em> provided by <code>CartoDB</code> using the <code>addProviderTiles</code> function. Then we set polygons and legends on the map. We also change the name of each element in the legend to make it more sensible.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">map1 <span style="color:#f92672">&lt;-</span> m <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">addProviderTiles</span>(providers<span style="color:#f92672">$</span>CartoDB.DarkMatter) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">addPolygons</span>(fillColor <span style="color:#f92672">=</span> <span style="color:#f92672">~</span><span style="color:#a6e22e">pal</span>(col),
              weight <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>,
              opacity <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>,
              color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>,
              dashArray <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;3&#34;</span>,
              fillOpacity <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>,
              label <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;Kecamatan: &#34;</span>, jakarta_hidran_sf<span style="color:#f92672">$</span>NAME_3),
              popup <span style="color:#f92672">=</span> popup.cont) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">addLegend</span>(<span style="color:#e6db74">&#34;bottomright&#34;</span>, 
            pal <span style="color:#f92672">=</span> pal,
            values <span style="color:#f92672">=</span> <span style="color:#f92672">~</span>col,
            title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hydrant Condition&#34;</span>,
            labFormat <span style="color:#f92672">=</span> <span style="color:#a6e22e">labelFormat</span>(digits <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>),
            opacity <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)

map1
</code></pre></div><!-- raw HTML omitted -->
<p>For the record, we can also arrange each part of the <em>legend</em> by adjusting the colors one by one (taken by using <code>inspect element</code>) and we can label it from there. If it is not done like this, then the text in the legend cannot be changed and is still shown in numeric form even though it has been given the <code>labels</code> parameter. Also, be aware that in order for the <code>colors</code> parameter to work, the <code>pal</code> parameter in <code>addLegend</code> must be removed.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">map2 <span style="color:#f92672">&lt;-</span> m <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">addProviderTiles</span>(providers<span style="color:#f92672">$</span>CartoDB.DarkMatter) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">addPolygons</span>(fillColor <span style="color:#f92672">=</span> <span style="color:#f92672">~</span><span style="color:#a6e22e">pal</span>(col),
              weight <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>,
              opacity <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>,
              color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>,
              dashArray <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;3&#34;</span>,
              fillOpacity <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>,
              label <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;Kecamatan: &#34;</span>, jakarta_hidran_sf<span style="color:#f92672">$</span>NAME_3),
              popup <span style="color:#f92672">=</span> popup.cont) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">addLegend</span>(<span style="color:#e6db74">&#34;bottomright&#34;</span>, 
            values <span style="color:#f92672">=</span> <span style="color:#f92672">~</span>col,
            colors <span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;#D7191C&#34;</span>, <span style="color:#e6db74">&#34;#FDAE61&#34;</span>, <span style="color:#e6db74">&#34;#FFFFBF&#34;</span>, <span style="color:#e6db74">&#34;#ABD9E9&#34;</span>, <span style="color:#e6db74">&#34;#2C7BB6&#34;</span>), <span style="color:#75715e"># Taken from `inspect element` with condition parameter `pal` exists</span>
            labels<span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Terrible&#34;</span>, <span style="color:#e6db74">&#34;Bad&#34;</span>, <span style="color:#e6db74">&#34;Decent/No Hydrant&#34;</span>, <span style="color:#e6db74">&#34;Good&#34;</span>, <span style="color:#e6db74">&#34;Great&#34;</span>),
            title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hydrant Condition&#34;</span>,
            labFormat <span style="color:#f92672">=</span> <span style="color:#a6e22e">labelFormat</span>(digits <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>),
            opacity <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)
map2
</code></pre></div><!-- raw HTML omitted -->
<h2 id="additional-information">Additional Information</h2>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p><a href="https://www.data-to-viz.com/">https://www.data-to-viz.com/</a> - examples of using maps for data&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p><a href="http://webhelp.esri.com/arcgisdesktop/9.3/index.cfm?TopicName=Shapefile_file_extensions">http://webhelp.esri.com/arcgisdesktop/9.3/index.cfm?TopicName=Shapefile_file_extensions</a> - Information about extensions from shapefiles&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3" role="doc-endnote">
<p>If the data we read has a meeting point, we can simplify it before we extract them to avoid things that are not desirable. This can be done by <code>simplify</code> at the top right. To see information for each point, please check the <code>?</code> Section.&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4" role="doc-endnote">
<p><a href="https://stackoverflow.com/questions/14740705/difference-between-geojson-and-topojson">https://stackoverflow.com/questions/14740705/difference-between-geojson-and-topojson</a> - Differences between GeoJSON and TopoJSON&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5" role="doc-endnote">
<p><a href="http://strimas.com/r/tidy-sf/">http://strimas.com/r/tidy-sf/</a> - <code>sf</code> replaces <code>sp</code> to handle spatial objects, and is formed to complement <code>tidyverse</code>&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

  </div>

  <footer>
    <ul class="stats">
  <li class="categories">
    <ul>
        
            
            
                <i class="fa fa-folder"></i>
                
                
                <li><a class="article-category-link" href="https://algotech.netlify.com/categories/r">R</a></li>
                
            
        
    </ul>
  </li>
  <li class="tags">
    <ul>
        
            
            
                <i class="fa fa-tags"></i>
                
                
                <li><a class="article-category-link" href="https://algotech.netlify.com/tags/geocoding">Geocoding</a></li>
                
                
                <li><a class="article-category-link" href="https://algotech.netlify.com/tags/mapshaper">Mapshaper</a></li>
                
                
                <li><a class="article-category-link" href="https://algotech.netlify.com/tags/leaflet">Leaflet</a></li>
                
                
                <li><a class="article-category-link" href="https://algotech.netlify.com/tags/map">Map</a></li>
                
                
                <li><a class="article-category-link" href="https://algotech.netlify.com/tags/data-visualization">Data Visualization</a></li>
                
            
        
    </ul>
  </li>
</ul>

  </footer>

</article>

    <article class="post">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-algotech-netlify-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </article>


<ul class="actions pagination">
    
        <li><a href="https://algotech.netlify.com/blog/self-organizing-maps/"
                class="button big previous">Self-Organizing Maps</a></li>
    

    
        <li><a href="https://algotech.netlify.com/blog/tidymodels/"
                class="button big next">Introduction to tidymodels</a></li>
    
</ul>


    </div>
    
<section id="sidebar">

  
  <section id="intro">
    
    
      
        <a href='https://algotech.netlify.com/'><img src="https://algotech.netlify.com/img/main/logo.png" class="intro-circle" width="30%" alt="Hugo Future Imperfect" /></a>
      
    
    
      <header>
        <h2>Algoritma Technical Blog</h2>
        <p>We're a group of people who teach data science to individuals, trains companies and their employees to better profit from data. We care about the development of data science and a sense of community that connects our alumni and team with one another. To learn more about our approach to data science problems, feel free to hop over to our blog.</p>
      </header>
    
    
      <ul class="icons">
        
        
  <li><a href="//github.com/teamalgoritma" target="_blank" title="GitHub" class="fa fa-github"></a></li>



























  <li><a href="//linkedin.com/company/teamalgoritma" target="_blank" title="LinkedIn Company" class="fa fa-linkedin"></a></li>









  <li><a href="//facebook.com/teamalgoritma" target="_blank" title="Facebook" class="fa fa-facebook"></a></li>





















  <li><a href="//instagram.com/teamalgoritma" target="_blank" title="Instagram" class="fa fa-instagram"></a></li>





  <li><a href="//twitter.com/teamalgoritma" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>




















      </ul>
    
  </section>

  
  <section class="recent-posts">
    <div class="mini-posts">
      <header>
        <h3>Upcoming Workshop</h3>
      </header>
      <div class="posts-container">
          <article class="mini-post">
            <header>
              
              
              <h3>
                <a href="https://algorit.ma/ds-course/dss-trading/?utm_source=algotech"><img src="https://algotech.netlify.com/img/2021/ads/dss-okt.png", alt="Building Algorithmic Trading Dashboard",  width="270" height="340">More details</a>
              </h3>
              
              <h3>
                <a href="https://algorit.ma/dds-oil-gas/?utm_source=algotech"><img src="https://algotech.netlify.com/img/2021/ads/dds-oilgas.png", alt="DDS: Secrets to a Successful Analytics Project in the Oil and Gas Industry",  width="270" height="340">More details</a>
              </h3>
            </header>
          </article>
      </div>

      
      
    </div>
  </section>

  
  
  

  
  

  
  <section id="footer">
    <p class="copyright">
      
        &copy; 2021
        
          Algoritma Technical Blog
        
      .
      Powered by <a href="//gohugo.io" target="_blank">Hugo</a>
    </p>
  </section>
</section>

    </div>
    <a id="back-to-top" href="#" class="fa fa-arrow-up fa-border fa-2x"></a>
    <style>
      .footer {
        position: fixed;
        left: 0;
        bottom: 0;
        width: 100%;
        height:50px; 
        background-color: black;
        color: white;
        text-align: center;
        padding-top: 15px;
        padding-bottom: 15px;
        padding-left: 50px;
        padding-right: 50px;
}
      }


      </style>

      <div class="footer">
        <p>
          Want to know more about our workshop?
          <a href="https://algorit.ma/?utm_source=algotech&utm_medium=content&utm_campaign=creating-choropleth-with-mapshaper-and-r" style="color: rgb(197, 38, 38)"> Visit our main website here</a> <br>
        </p>
          
      </div>
    

    
      
    

    
      
      
      
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>
        
        
        
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/yaml.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/css.min.js"></script>
        <script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>
      
    
    
    
      <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.js"></script>
      <script src="https://algotech.netlify.com/js/util.js"></script>
      <script src="https://algotech.netlify.com/js/main.js"></script>
      <script src="https://algotech.netlify.com/js/backToTop.js"></script>
    

    
      
        
      
        
          <script src="https://algotech.netlify.com/js/bootstrap.min.js"></script>
        
      
    

    
    <script>hljs.initHighlightingOnLoad();</script>
      <script src="//yihui.name/js/math-code.js"></script>
<script async
src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


  </body>
</html>

